<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 5.4.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"example.com","root":"/","scheme":"Pisces","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":true,"show_result":true,"style":"flat"},"back2top":{"enable":true,"sidebar":false,"scrollpercent":true},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":"gitalk","storage":true,"lazyload":false,"nav":null,"activeClass":"gitalk"},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":true,"trigger":"auto","top_n_per_article":5,"unescape":false,"preload":"falses"},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},"path":"search.xml"};
  </script>

  <meta name="description" content="iOS developer">
<meta property="og:type" content="website">
<meta property="og:title" content="我不是诸葛亮">
<meta property="og:url" content="http://example.com/page/3/index.html">
<meta property="og:site_name" content="我不是诸葛亮">
<meta property="og:description" content="iOS developer">
<meta property="og:locale" content="zh_CN">
<meta property="article:author" content="zhuguanliang">
<meta property="article:tag" content="Swift Object-C">
<meta name="twitter:card" content="summary">

<link rel="canonical" href="http://example.com/page/3/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : true,
    isPost : false,
    lang   : 'zh-CN'
  };
</script>

  <title>我不是诸葛亮</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

<link rel="alternate" href="/atom.xml" title="我不是诸葛亮" type="application/atom+xml">
</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">我不是诸葛亮</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
      <p class="site-subtitle" itemprop="description">宁可碌碌，不可无为</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档</a>

  </li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>搜索
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup">
        <div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off"
           placeholder="搜索..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div id="search-result">
  <div id="no-result">
    <i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>
  </div>
</div>

    </div>
  </div>

</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>
  <div class="reading-progress-bar"></div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content index posts-expand">
            
      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://example.com/2019/04/19/oc%E7%89%88%E6%9C%AC%E7%9A%84%E6%96%B0%E9%97%BBApp%EF%BC%886%EF%BC%89/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.png">
      <meta itemprop="name" content="zhuguanliang">
      <meta itemprop="description" content=" iOS developer">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="我不是诸葛亮">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2019/04/19/oc%E7%89%88%E6%9C%AC%E7%9A%84%E6%96%B0%E9%97%BBApp%EF%BC%886%EF%BC%89/" class="post-title-link" itemprop="url">oc版本的新闻App（6）</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2019-04-19 12:49:00" itemprop="dateCreated datePublished" datetime="2019-04-19T12:49:00+08:00">2019-04-19</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2021-02-01 14:49:00" itemprop="dateModified" datetime="2021-02-01T14:49:00+08:00">2021-02-01</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="重构视频列表"><a href="#重构视频列表" class="headerlink" title="重构视频列表"></a>重构视频列表</h2><h3 id="新建VideoController文件夹，将之前建好的放进去"><a href="#新建VideoController文件夹，将之前建好的放进去" class="headerlink" title="新建VideoController文件夹，将之前建好的放进去"></a>新建VideoController文件夹，将之前建好的放进去</h3><img src="https://gitee.com/zhu565615430/images/raw/master/imas/image-20210113215939815.png" alt="image-20210113215939815" style="zoom:50%;">



<h3 id="新建GTVideoCoverView"><a href="#新建GTVideoCoverView" class="headerlink" title="新建GTVideoCoverView"></a>新建GTVideoCoverView</h3><p><img src="https://gitee.com/zhu565615430/images/raw/master/imas/image-20210114152957357.png"></p>
<p><img src="https://gitee.com/zhu565615430/images/raw/master/imas/image-20210114004937065.png" alt="image-20210114004937065"></p>
<p><img src="https://gitee.com/zhu565615430/images/raw/master/imas/image-20210514112223575.png" alt="image-20210514112223575"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">#import &lt;UIKit/UIKit.h&gt;</span><br><span class="line"></span><br><span class="line">NS_ASSUME_NONNULL_BEGIN</span><br><span class="line"></span><br><span class="line">/**</span><br><span class="line"> 视频ViewController collectionView Item</span><br><span class="line"> */</span><br><span class="line">@interface GTVideoCoverView : UICollectionViewCell</span><br><span class="line"></span><br><span class="line">/**</span><br><span class="line"> 根据数据布局，封面图&amp;播放 url</span><br><span class="line"> */</span><br><span class="line">- (void)layoutWithVideoCoverUrl:(NSString *)videoCoverUrl videoUrl:(NSString *)videoUrl;</span><br><span class="line">@end</span><br><span class="line"></span><br><span class="line">NS_ASSUME_NONNULL_END</span><br></pre></td></tr></table></figure>

<p><img src="https://gitee.com/zhu565615430/images/raw/master/imas/image-20210114151736592.png" alt="image-20210114151736592"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line">#import &quot;GTVideoCoverView.h&quot;</span><br><span class="line">@interface GTVideoCoverView ()</span><br><span class="line">@property (nonatomic, strong, readwrite) UIImageView *coverView;</span><br><span class="line">@property (nonatomic, strong, readwrite) UIImageView *playButton;</span><br><span class="line">@property (nonatomic, copy, readwrite) NSString *videoUrl;</span><br><span class="line">@end</span><br><span class="line"></span><br><span class="line">@implementation GTVideoCoverView</span><br><span class="line"></span><br><span class="line">- (instancetype)initWithFrame:(CGRect)frame &#123;</span><br><span class="line">    self = [super initWithFrame:frame];</span><br><span class="line">    if (self) &#123;</span><br><span class="line">        [self addSubview:(&#123;</span><br><span class="line">            _coverView = [[UIImageView alloc] initWithFrame:CGRectMake(0, 0, frame.size.width, frame.size.height)];</span><br><span class="line">            _coverView;</span><br><span class="line">        &#125;)];</span><br><span class="line"></span><br><span class="line">        [_coverView addSubview:(&#123;</span><br><span class="line">            _playButton = [[UIImageView alloc] initWithFrame:CGRectMake((frame.size.width - 50)/2, (frame.size.height - 50)/2, 50, 50)];</span><br><span class="line">            _playButton.image = [UIImage imageNamed:@&quot;icon.bundle/ VIdeobofang.png&quot;];</span><br><span class="line">            _playButton;</span><br><span class="line">        &#125;)];</span><br><span class="line">        //点击全部Item都支持播放</span><br><span class="line">        UITapGestureRecognizer *tapGesture = [[UITapGestureRecognizer alloc] initWithTarget:self action:@selector(_tapToPlay)];</span><br><span class="line">        [self addGestureRecognizer:tapGesture];</span><br><span class="line">    &#125;</span><br><span class="line">    return self;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">#pragma mark - public method</span><br><span class="line"></span><br><span class="line">- (void)layoutWithVideoCoverUrl:(NSString *)videoCoverUrl videoUrl:(NSString *)videoUrl &#123;</span><br><span class="line">    _coverView.image = [UIImage imageNamed:videoCoverUrl];</span><br><span class="line">    _videoUrl = videoUrl;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">#pragma mark - private method</span><br><span class="line"></span><br><span class="line">- (void)_tapToPlay &#123;</span><br><span class="line">    //在当前Item上播放视频</span><br><span class="line">    NSLog(@&quot;&quot;);</span><br><span class="line">&#125;</span><br><span class="line">@end</span><br></pre></td></tr></table></figure>

<p><img src="https://gitee.com/zhu565615430/images/raw/master/imas/image-20210514112314318.png" alt="image-20210514112314318"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">#import &quot;GTVideoCoverView.h&quot;</span><br></pre></td></tr></table></figure>

<p><img src="https://gitee.com/zhu565615430/images/raw/master/imas/image-20210114151938859.png" alt="image-20210114151938859"></p>
<p><img src="https://gitee.com/zhu565615430/images/raw/master/imas/image-20210114152015694.png" alt="image-20210114152015694"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">Scheme    </span><br><span class="line">1    </span><br><span class="line">    flowLayout.itemSize = CGSizeMake(self.view.frame.size.width,self.view.frame.size.width / 16*9);</span><br><span class="line">    </span><br><span class="line">2    </span><br><span class="line">    [collectionView registerClass:[GTVideoCoverView class] forCellWithReuseIdentifier:@&quot;GTVideoCoverView&quot;];//注册重用的cell</span><br><span class="line">    </span><br><span class="line">3    </span><br><span class="line">    UICollectionViewCell *cell = [collectionView dequeueReusableCellWithReuseIdentifier:@&quot;GTVideoCoverView&quot; forIndexPath:indexPath];</span><br><span class="line">    </span><br><span class="line">    if ([cell isKindOfClass:[GTVideoCoverView class]]) &#123;</span><br><span class="line">        //方便讲解事例数据</span><br><span class="line">        [(GTVideoCoverView *)cell layoutWithVideoCoverUrl:@&quot;icon.bundle/Video.png&quot; videoUrl:@&quot;https://0x9.me/PzdXc&quot;];</span><br><span class="line">    &#125;</span><br><span class="line">        </span><br></pre></td></tr></table></figure>

<h3 id="添加播放功能"><a href="#添加播放功能" class="headerlink" title="添加播放功能"></a>添加播放功能</h3><p><img src="https://gitee.com/zhu565615430/images/raw/master/imas/image-20210514112609925.png" alt="image-20210514112609925"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">#import &lt;AVFoundation/AVFoundation.h&gt;</span><br></pre></td></tr></table></figure>

<p><img src="https://gitee.com/zhu565615430/images/raw/master/imas/image-20210114172430253.png" alt="image-20210114172430253"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">NSURL *videoURL = [NSURL URLWithString:_videoUrl];</span><br><span class="line"></span><br><span class="line">AVAsset *asset = [AVAsset assetWithURL:videoURL];</span><br><span class="line"></span><br><span class="line">AVPlayer *videoItem = [AVPlayerItem playerItemWithAsset:asset];</span><br><span class="line"></span><br><span class="line">AVPlayer *avPlayer = [AVPlayer playerWithPlayerItem:videoItem];</span><br><span class="line"></span><br><span class="line">AVPlayerLayer *playerLayer = [AVPlayerLayer playerLayerWithPlayer:avPlayer];</span><br><span class="line">playerLayer.frame = _coverView.bounds;</span><br><span class="line">[_coverView.layer addSublayer:playerLayer];</span><br><span class="line"></span><br><span class="line">[avPlayer play];</span><br></pre></td></tr></table></figure>

<p><img src="https://gitee.com/zhu565615430/images/raw/master/imas/image-20210514112701308.png" alt="image-20210514112701308"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[(GTVideoCoverView *)cell layoutWithVideoCoverUrl:@&quot;icon.bundle/Video.png&quot; videoUrl:@&quot;http://sns-video-qc.xhscdn.com/d43514414bf02ff023c52b80362e914b663bdc83_v1_ln?sign=6bbeae5060160f3cd1f84e708c9413f7&amp;t=6001bad4&quot;];</span><br></pre></td></tr></table></figure>

<p>视频播放完成获得通知</p>
<p><img src="https://gitee.com/zhu565615430/images/raw/master/imas/image-20210114174707956.png" alt="image-20210114174707956"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">    [[NSNotificationCenter defaultCenter] addObserver:self selector:@selector(_handlePlayEnd) name:AVPlayerItemDidPlayToEndTimeNotification object:nil];//注册通知</span><br><span class="line">&#125;</span><br><span class="line">return self;</span><br><span class="line">[[NSNotificationCenter defaultCenter] removeObserver:self];//移除</span><br></pre></td></tr></table></figure>

<p><img src="https://gitee.com/zhu565615430/images/raw/master/imas/image-20210114174756491.png" alt="image-20210114174756491"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">- (void) _handlePlayEnd&#123;</span><br><span class="line">    </span><br><span class="line">    NSLog(@&quot;&quot;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="播放完成退出播放操作"><a href="#播放完成退出播放操作" class="headerlink" title="播放完成退出播放操作"></a>播放完成退出播放操作</h3><p><img src="https://gitee.com/zhu565615430/images/raw/master/imas/image-20210114180032098.png" alt="image-20210114180032098"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">@property (nonatomic, strong, readwrite) AVPlayerItem *videoItem;</span><br><span class="line">@property (nonatomic, strong, readwrite) AVPlayer *avPlayer;</span><br><span class="line">@property (nonatomic, copy, readwrite) AVPlayerLayer *playerLayer;</span><br></pre></td></tr></table></figure>

<p><img src="https://gitee.com/zhu565615430/images/raw/master/imas/image-20210114180119940.png" alt="image-20210114180119940"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">    _videoItem = [AVPlayerItem playerItemWithAsset:asset];</span><br><span class="line">    </span><br><span class="line">    _avPlayer = [AVPlayer playerWithPlayerItem:_videoItem];</span><br><span class="line">    </span><br><span class="line">    _playerLayer = [AVPlayerLayer playerLayerWithPlayer:_avPlayer];</span><br><span class="line">    _playerLayer.frame = _coverView.bounds;</span><br><span class="line">    [_coverView.layer addSublayer:_playerLayer];</span><br><span class="line">    </span><br><span class="line">    [_avPlayer play];</span><br><span class="line">    </span><br><span class="line">    NSLog(@&quot;&quot;);</span><br><span class="line">&#125;</span><br><span class="line">- (void) _handlePlayEnd&#123;</span><br><span class="line">    [_playerLayer removeFromSuperlayer];</span><br><span class="line">    _videoItem = nil;</span><br><span class="line">    _avPlayer = nil;</span><br></pre></td></tr></table></figure>

<h3 id="通过KVO监听播放资源的状态"><a href="#通过KVO监听播放资源的状态" class="headerlink" title="通过KVO监听播放资源的状态"></a>通过KVO监听播放资源的状态</h3><p><img src="https://gitee.com/zhu565615430/images/raw/master/imas/image-20210114182745589.png" alt="image-20210114182745589"></p>
<p><img src="https://gitee.com/zhu565615430/images/raw/master/imas/image-20210114182904689.png" alt="image-20210114182904689"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">    [_videoItem removeObserver:self forKeyPath:@&quot;status&quot;];</span><br><span class="line">    </span><br><span class="line">    [_videoItem addObserver:self forKeyPath:@&quot;status&quot; options:NSKeyValueObservingOptionNew context:nil];</span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">    #pragma mark - KVO</span><br><span class="line">- (void)observeValueForKeyPath:(NSString *)keyPath ofObject:(id)object change:(NSDictionary&lt;NSKeyValueChangeKey,id&gt; *)change context:(void *)context&#123;</span><br><span class="line">    if ([keyPath isEqualToString:@&quot;status&quot;]) &#123;</span><br><span class="line">        if (((NSNumber *)[change objectForKey:NSKeyValueChangeNewKey]).integerValue == AVPlayerItemStatusReadyToPlay) &#123;</span><br><span class="line">            [_avPlayer play];</span><br><span class="line">        &#125;else&#123;</span><br><span class="line">            NSLog(@&quot;&quot;);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="监听视频播放的缓冲与进度（1）"><a href="#监听视频播放的缓冲与进度（1）" class="headerlink" title="监听视频播放的缓冲与进度（1）"></a>监听视频播放的缓冲与进度（1）</h3><p><img src="https://gitee.com/zhu565615430/images/raw/master/imas/image-20210114194035692.png" alt="image-20210114194035692"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">[_videoItem removeObserver:self forKeyPath:@&quot;loadedRimeRanges&quot;];</span><br><span class="line"></span><br><span class="line">[_videoItem addObserver:self forKeyPath:@&quot;loadedRimeRanges&quot; options:NSKeyValueObservingOptionNew context:nil];</span><br><span class="line"></span><br><span class="line">CMTime duration = _videoItem.duration;</span><br><span class="line">CGFloat videoDuration = CMTimeGetSeconds(duration);</span><br></pre></td></tr></table></figure>

<p><img src="https://gitee.com/zhu565615430/images/raw/master/imas/image-20210114194219900.png" alt="image-20210114194219900"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">    [_avPlayer addPeriodicTimeObserverForInterval:CMTimeMake(1,1) queue:dispatch_get_main_queue() usingBlock:^(CMTime time) &#123;</span><br><span class="line">        NSLog(@&quot;播放进度：%@&quot;,@(CMTimeGetSeconds(time)));</span><br><span class="line">    &#125;];</span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">    [_avPlayer seekToTime:CMTimeMake(0, 1)];</span><br><span class="line">    [_avPlayer play];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="https://gitee.com/zhu565615430/images/raw/master/imas/image-20210514112814433.png" alt="image-20210514112814433"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&#125;else if ([keyPath isEqualToString:@&quot;loadedRimeRanges&quot;])&#123;</span><br><span class="line">    NSLog(@&quot;缓冲：%@&quot;,[change objectForKey:NSKeyValueChangeNewKey]);</span><br></pre></td></tr></table></figure>

<h3 id="监听视频播放的缓冲与进度（2）"><a href="#监听视频播放的缓冲与进度（2）" class="headerlink" title="监听视频播放的缓冲与进度（2）"></a>监听视频播放的缓冲与进度（2）</h3><h2 id="建立一个视频播放器"><a href="#建立一个视频播放器" class="headerlink" title="建立一个视频播放器"></a>建立一个视频播放器</h2><img src="https://gitee.com/zhu565615430/images/raw/master/imas/image-20210114194703986.png" alt="image-20210114194703986" style="zoom:50%;">

<p><img src="https://gitee.com/zhu565615430/images/raw/master/imas/image-20210114230437235.png" alt="image-20210114230437235"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">#import &lt;Foundation/Foundation.h&gt;</span><br><span class="line">#import &lt;UIKit/UIKit.h&gt;</span><br><span class="line"></span><br><span class="line">NS_ASSUME_NONNULL_BEGIN</span><br><span class="line"></span><br><span class="line">@interface GTVideoPlayer : NSObject</span><br><span class="line"></span><br><span class="line">/**</span><br><span class="line"> 全局播放器单例</span><br><span class="line"> */</span><br><span class="line">+ (GTVideoPlayer *)Player;</span><br><span class="line"></span><br><span class="line">/**</span><br><span class="line"> 在指定View上 通过url播放视频</span><br><span class="line"> */</span><br><span class="line">- (void)playVideoWithUrl:(NSString *)videoUrl attachView:(UIView *)attachView;</span><br><span class="line"></span><br><span class="line">@end</span><br><span class="line"></span><br><span class="line">NS_ASSUME_NONNULL_END</span><br></pre></td></tr></table></figure>

<img src="https://gitee.com/zhu565615430/images/raw/master/imas/image-20210114230544663.png" alt="image-20210114230544663" style="zoom:50%;">

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br></pre></td><td class="code"><pre><span class="line">#import &quot;GTVideoPlayer.h&quot;</span><br><span class="line">#import &lt;AVFoundation/AVFoundation.h&gt;</span><br><span class="line"></span><br><span class="line">@interface GTVideoPlayer()</span><br><span class="line"></span><br><span class="line">@property (nonatomic, strong, readwrite) AVPlayerItem *videoItem;</span><br><span class="line">@property (nonatomic, strong, readwrite) AVPlayer *avPlayer;</span><br><span class="line">@property (nonatomic, copy, readwrite) AVPlayerLayer *playerLayer;</span><br><span class="line"></span><br><span class="line">@end</span><br><span class="line"></span><br><span class="line">@implementation GTVideoPlayer</span><br><span class="line"></span><br><span class="line">+ (GTVideoPlayer *)Player &#123;</span><br><span class="line">    static GTVideoPlayer *player;</span><br><span class="line">    static dispatch_once_t onceToken;</span><br><span class="line">    dispatch_once(&amp;onceToken, ^&#123;</span><br><span class="line">        player = [[GTVideoPlayer alloc] init];</span><br><span class="line">    &#125;);</span><br><span class="line">    return player;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (void)playVideoWithUrl:(NSString *)videoUrl attachView:(UIView *)attachView&#123;</span><br><span class="line">    </span><br><span class="line">    //首先停止播放</span><br><span class="line">    [self _stopPlay];</span><br><span class="line">    </span><br><span class="line">    //在当前Item上播放视频</span><br><span class="line">    NSURL *videoURL = [NSURL URLWithString:videoUrl];</span><br><span class="line">    </span><br><span class="line">    AVAsset *asset = [AVAsset assetWithURL:videoURL];</span><br><span class="line"></span><br><span class="line">    _videoItem = [AVPlayerItem playerItemWithAsset:asset];</span><br><span class="line">    [_videoItem addObserver:self forKeyPath:@&quot;status&quot; options:NSKeyValueObservingOptionNew context:nil];</span><br><span class="line">    [_videoItem addObserver:self forKeyPath:@&quot;loadedRimeRanges&quot; options:NSKeyValueObservingOptionNew context:nil];</span><br><span class="line">    </span><br><span class="line">    CMTime duration = _videoItem.duration;</span><br><span class="line">    CGFloat videoDuration = CMTimeGetSeconds(duration);</span><br><span class="line">    </span><br><span class="line">    _avPlayer = [AVPlayer playerWithPlayerItem:_videoItem];</span><br><span class="line">    [_avPlayer addPeriodicTimeObserverForInterval:CMTimeMake(1,1) queue:dispatch_get_main_queue() usingBlock:^(CMTime time) &#123;</span><br><span class="line">        NSLog(@&quot;播放进度：%@&quot;,@(CMTimeGetSeconds(time)));</span><br><span class="line">    &#125;];</span><br><span class="line">    </span><br><span class="line">    _playerLayer = [AVPlayerLayer playerLayerWithPlayer:_avPlayer];</span><br><span class="line">    _playerLayer.frame = attachView.bounds;</span><br><span class="line">    [attachView.layer addSublayer:_playerLayer];</span><br><span class="line">    </span><br><span class="line">    [[NSNotificationCenter defaultCenter] addObserver:self selector:@selector(_handlePlayEnd) name:AVPlayerItemDidPlayToEndTimeNotification object:nil];//注册通知</span><br><span class="line">    </span><br><span class="line">&#125;</span><br><span class="line">- (void)_stopPlay &#123;</span><br><span class="line">    //移除监听</span><br><span class="line">    [[NSNotificationCenter defaultCenter] removeObserver:self];</span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">    [_playerLayer removeFromSuperlayer];</span><br><span class="line">    </span><br><span class="line">    [_videoItem removeObserver:self forKeyPath:@&quot;status&quot;];</span><br><span class="line">    [_videoItem removeObserver:self forKeyPath:@&quot;loadedRimeRanges&quot;];</span><br><span class="line">    _videoItem = nil;</span><br><span class="line">    </span><br><span class="line">    _avPlayer = nil;</span><br><span class="line"></span><br><span class="line">    </span><br><span class="line">    NSLog(@&quot;&quot;);</span><br><span class="line">&#125;</span><br><span class="line">- (void) _handlePlayEnd&#123;</span><br><span class="line"></span><br><span class="line">    </span><br><span class="line">    [_avPlayer seekToTime:CMTimeMake(0, 1)];</span><br><span class="line">    [_avPlayer play];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">#pragma mark - KVO</span><br><span class="line">- (void)observeValueForKeyPath:(NSString *)keyPath ofObject:(id)object change:(NSDictionary&lt;NSKeyValueChangeKey,id&gt; *)change context:(void *)context&#123;</span><br><span class="line">    if ([keyPath isEqualToString:@&quot;status&quot;]) &#123;</span><br><span class="line">        if (((NSNumber *)[change objectForKey:NSKeyValueChangeNewKey]).integerValue == AVPlayerItemStatusReadyToPlay) &#123;</span><br><span class="line">            [_avPlayer play];</span><br><span class="line">        &#125;else&#123;</span><br><span class="line">            NSLog(@&quot;&quot;);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;else if ([keyPath isEqualToString:@&quot;loadedRimeRanges&quot;])&#123;</span><br><span class="line">        NSLog(@&quot;缓冲：%@&quot;,[change objectForKey:NSKeyValueChangeNewKey]);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">@end</span><br></pre></td></tr></table></figure>

<p><img src="https://gitee.com/zhu565615430/images/raw/master/imas/image-20210114231703891.png" alt="image-20210114231703891"></p>
<p><img src="https://gitee.com/zhu565615430/images/raw/master/imas/image-20210114231729970.png" alt="image-20210114231729970"></p>
<h3 id="使用AutoLayout实现列表toolbar，并添加上相应图片"><a href="#使用AutoLayout实现列表toolbar，并添加上相应图片" class="headerlink" title="使用AutoLayout实现列表toolbar，并添加上相应图片"></a>使用AutoLayout实现列表toolbar，并添加上相应图片</h3><p>新建GTVideoToolbar</p>
<p><img src="https://gitee.com/zhu565615430/images/raw/master/imas/image-20210114232655759.png" alt="image-20210114232655759"></p>
<p><img src="https://gitee.com/zhu565615430/images/raw/master/imas/image-20210116151820470.png" alt="image-20210116151820470"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">#import &lt;UIKit/UIKit.h&gt;</span><br><span class="line"></span><br><span class="line">#define GTVideoToolbarHeight 60</span><br><span class="line"></span><br><span class="line">NS_ASSUME_NONNULL_BEGIN</span><br><span class="line"></span><br><span class="line">@interface GTVideoToolbar : UIView</span><br><span class="line"></span><br><span class="line">- (void)layoutWithModel:(id)model;</span><br><span class="line"></span><br><span class="line">@end</span><br><span class="line"></span><br><span class="line">NS_ASSUME_NONNULL_END</span><br></pre></td></tr></table></figure>

<p><img src="https://gitee.com/zhu565615430/images/raw/master/imas/image-20210116151916188.png" alt="image-20210116151916188"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br></pre></td><td class="code"><pre><span class="line">#import &quot;GTVideoToolbar.h&quot;</span><br><span class="line"></span><br><span class="line">@interface GTVideoToolbar ()</span><br><span class="line"></span><br><span class="line">@property (nonatomic, strong, readwrite) UIImageView *avatorImageView;</span><br><span class="line">@property (nonatomic, strong, readwrite) UILabel *nickLabel;</span><br><span class="line"></span><br><span class="line">@property (nonatomic, strong, readwrite) UIImageView *commentImageView;</span><br><span class="line">@property (nonatomic, strong, readwrite) UILabel *commentLabel;</span><br><span class="line"></span><br><span class="line">@property (nonatomic, strong, readwrite) UIImageView *likeImageView;</span><br><span class="line">@property (nonatomic, strong, readwrite) UILabel *likeLabel;</span><br><span class="line"></span><br><span class="line">@property (nonatomic, strong, readwrite) UIImageView *shareImageView;</span><br><span class="line">@property (nonatomic, strong, readwrite) UILabel *shareLabel;</span><br><span class="line"></span><br><span class="line">@end</span><br><span class="line"></span><br><span class="line">@implementation GTVideoToolbar</span><br><span class="line"></span><br><span class="line">- (instancetype)initWithFrame:(CGRect)frame &#123;</span><br><span class="line">    self = [super initWithFrame:frame];</span><br><span class="line">    if (self) &#123;</span><br><span class="line"></span><br><span class="line">        self.backgroundColor = [UIColor whiteColor];</span><br><span class="line"></span><br><span class="line">        [self addSubview:(&#123;</span><br><span class="line">            _avatorImageView = [[UIImageView alloc] initWithFrame:CGRectZero];</span><br><span class="line">            _avatorImageView.layer.masksToBounds = YES;</span><br><span class="line">            _avatorImageView.layer.cornerRadius = 15;</span><br><span class="line">            _avatorImageView.translatesAutoresizingMaskIntoConstraints = NO;</span><br><span class="line">            _avatorImageView;</span><br><span class="line">        &#125;)];</span><br><span class="line">        [self addSubview:(&#123;</span><br><span class="line">            _nickLabel = [[UILabel alloc] init];</span><br><span class="line">            _nickLabel.font = [UIFont systemFontOfSize:15];</span><br><span class="line">            _nickLabel.textColor = [UIColor lightGrayColor];</span><br><span class="line">            _nickLabel.translatesAutoresizingMaskIntoConstraints = NO;</span><br><span class="line">            _nickLabel;</span><br><span class="line">        &#125;)];</span><br><span class="line"></span><br><span class="line">        [self addSubview:(&#123;</span><br><span class="line">            _commentImageView = [[UIImageView alloc] initWithFrame:CGRectZero];</span><br><span class="line">            _commentImageView.layer.masksToBounds = YES;</span><br><span class="line">            _commentImageView.layer.cornerRadius = 15;</span><br><span class="line">            _commentImageView.translatesAutoresizingMaskIntoConstraints = NO;</span><br><span class="line"></span><br><span class="line">            _commentImageView;</span><br><span class="line">        &#125;)];</span><br><span class="line">        [self addSubview:(&#123;</span><br><span class="line">            _commentLabel = [[UILabel alloc] init];</span><br><span class="line">            _commentLabel.font = [UIFont systemFontOfSize:15];</span><br><span class="line">            _commentLabel.textColor = [UIColor lightGrayColor];</span><br><span class="line">            _commentLabel.translatesAutoresizingMaskIntoConstraints = NO;</span><br><span class="line"></span><br><span class="line">            _commentLabel;</span><br><span class="line">        &#125;)];</span><br><span class="line"></span><br><span class="line">        [self addSubview:(&#123;</span><br><span class="line">            _likeImageView = [[UIImageView alloc] initWithFrame:CGRectZero];</span><br><span class="line">            _likeImageView.layer.masksToBounds = YES;</span><br><span class="line">            _likeImageView.layer.cornerRadius = 15;</span><br><span class="line">            _likeImageView.translatesAutoresizingMaskIntoConstraints = NO;</span><br><span class="line"></span><br><span class="line">            _likeImageView;</span><br><span class="line">        &#125;)];</span><br><span class="line">        [self addSubview:(&#123;</span><br><span class="line">            _likeLabel = [[UILabel alloc] init];</span><br><span class="line">            _likeLabel.font = [UIFont systemFontOfSize:15];</span><br><span class="line">            _likeLabel.textColor = [UIColor lightGrayColor];</span><br><span class="line">            _likeLabel.translatesAutoresizingMaskIntoConstraints = NO;</span><br><span class="line"></span><br><span class="line">            _likeLabel;</span><br><span class="line">        &#125;)];</span><br><span class="line"></span><br><span class="line">        [self addSubview:(&#123;</span><br><span class="line">            _shareImageView = [[UIImageView alloc] initWithFrame:CGRectZero];</span><br><span class="line">            _shareImageView.layer.masksToBounds = YES;</span><br><span class="line">            _shareImageView.layer.cornerRadius = 15;</span><br><span class="line">            _shareImageView.translatesAutoresizingMaskIntoConstraints = NO;</span><br><span class="line">            _shareImageView.contentMode = UIViewContentModeScaleToFill;</span><br><span class="line">            _shareImageView;</span><br><span class="line">        &#125;)];</span><br><span class="line">        </span><br><span class="line">        [self addSubview:(&#123;</span><br><span class="line">            _shareLabel = [[UILabel alloc] init];</span><br><span class="line">            _shareLabel.font = [UIFont systemFontOfSize:15];</span><br><span class="line">            _shareLabel.textColor = [UIColor lightGrayColor];</span><br><span class="line">            _shareLabel.translatesAutoresizingMaskIntoConstraints = NO;</span><br><span class="line">            _shareLabel;</span><br><span class="line">        &#125;)];</span><br><span class="line">    &#125;</span><br><span class="line">    return self;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (void)layoutWithModel:(id)model &#123;</span><br><span class="line"></span><br><span class="line">    _avatorImageView.image = [UIImage imageNamed:@&quot;icon.bundle/icon.png&quot;];</span><br><span class="line">    _nickLabel.text = @&quot;北京时间&quot;;</span><br><span class="line"></span><br><span class="line">    _commentImageView.image = [UIImage imageNamed:@&quot;comment&quot;];</span><br><span class="line">    _commentLabel.text = @&quot;100&quot;;</span><br><span class="line"></span><br><span class="line">    _likeImageView.image = [UIImage imageNamed:@&quot;praise&quot;];</span><br><span class="line">    _likeLabel.text = @&quot;25&quot;;</span><br><span class="line"></span><br><span class="line">    _shareImageView.image = [UIImage imageNamed:@&quot;share&quot;];</span><br><span class="line">    _shareLabel.text = @&quot;分享&quot;;</span><br><span class="line"></span><br><span class="line">    [NSLayoutConstraint activateConstraints:@[</span><br><span class="line"></span><br><span class="line">         [NSLayoutConstraint constraintWithItem:_avatorImageView</span><br><span class="line">                                      attribute:NSLayoutAttributeCenterY</span><br><span class="line">                                      relatedBy:NSLayoutRelationEqual</span><br><span class="line">                                         toItem:self</span><br><span class="line">                                      attribute:NSLayoutAttributeCenterY</span><br><span class="line">                                     multiplier:1</span><br><span class="line">                                       constant:0],</span><br><span class="line"></span><br><span class="line">         [NSLayoutConstraint constraintWithItem:_avatorImageView</span><br><span class="line">                                      attribute:NSLayoutAttributeLeft</span><br><span class="line">                                      relatedBy:NSLayoutRelationEqual</span><br><span class="line">                                         toItem:self</span><br><span class="line">                                      attribute:NSLayoutAttributeLeft</span><br><span class="line">                                     multiplier:1</span><br><span class="line">                                       constant:15],</span><br><span class="line"></span><br><span class="line">         [NSLayoutConstraint constraintWithItem:_avatorImageView</span><br><span class="line">                                      attribute:NSLayoutAttributeWidth</span><br><span class="line">                                      relatedBy:NSLayoutRelationEqual</span><br><span class="line">                                         toItem:nil</span><br><span class="line">                                      attribute:NSLayoutAttributeNotAnAttribute</span><br><span class="line">                                     multiplier:1</span><br><span class="line">                                       constant:30],</span><br><span class="line"></span><br><span class="line">         [NSLayoutConstraint constraintWithItem:_avatorImageView</span><br><span class="line">                                      attribute:NSLayoutAttributeHeight</span><br><span class="line">                                      relatedBy:NSLayoutRelationEqual</span><br><span class="line">                                         toItem:nil</span><br><span class="line">                                      attribute:NSLayoutAttributeNotAnAttribute</span><br><span class="line">                                     multiplier:1</span><br><span class="line">                                       constant:30],</span><br><span class="line"></span><br><span class="line">         [NSLayoutConstraint constraintWithItem:_nickLabel</span><br><span class="line">                                      attribute:NSLayoutAttributeCenterY</span><br><span class="line">                                      relatedBy:NSLayoutRelationEqual</span><br><span class="line">                                         toItem:_avatorImageView</span><br><span class="line">                                      attribute:NSLayoutAttributeCenterY</span><br><span class="line">                                     multiplier:1</span><br><span class="line">                                       constant:0],</span><br><span class="line"></span><br><span class="line">         [NSLayoutConstraint constraintWithItem:_nickLabel</span><br><span class="line">                                      attribute:NSLayoutAttributeLeft</span><br><span class="line">                                      relatedBy:NSLayoutRelationEqual</span><br><span class="line">                                         toItem:_avatorImageView</span><br><span class="line">                                      attribute:NSLayoutAttributeRight</span><br><span class="line">                                     multiplier:1</span><br><span class="line">                                       constant:0],</span><br><span class="line"></span><br><span class="line">    ]];</span><br><span class="line"></span><br><span class="line">    NSString *vflString = @&quot;H:|-15-[_avatorImageView]-0-[_nickLabel]-(&gt;=0)-[_commentImageView(==_avatorImageView)]-0-[_commentLabel]-15-[_likeImageView(==_avatorImageView)]-0-[_likeLabel]-15-[_shareImageView(==_avatorImageView)]-0-[_shareLabel]-15-|&quot;;</span><br><span class="line"></span><br><span class="line">    [NSLayoutConstraint activateConstraints:[NSLayoutConstraint constraintsWithVisualFormat:vflString options:NSLayoutFormatAlignAllCenterY metrics:nil views:NSDictionaryOfVariableBindings(_avatorImageView, _nickLabel, _commentImageView, _commentLabel, _likeImageView, _likeLabel, _shareImageView, _shareLabel)]];</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">@end</span><br></pre></td></tr></table></figure>

<p><img src="https://gitee.com/zhu565615430/images/raw/master/imas/image-20210116152041731.png" alt="image-20210116152041731"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">#import &quot;GTVideoToolbar.h&quot;</span><br><span class="line"></span><br><span class="line">    flowLayout.itemSize = CGSizeMake(self.view.frame.size.width,self.view.frame.size.width / 16 * 9 + GTVideoToolbarHeight);</span><br></pre></td></tr></table></figure>

<p><img src="https://gitee.com/zhu565615430/images/raw/master/imas/image-20210116152203496.png" alt="image-20210116152203496"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">#import &quot;GTVideoToolbar.h&quot;</span><br><span class="line"></span><br><span class="line">@property (nonatomic, strong, readwrite) GTVideoToolbar *toolbar;</span><br><span class="line"></span><br><span class="line">_coverView = [[UIImageView alloc] initWithFrame:CGRectMake(0, 0, frame.size.width, frame.size.height - GTVideoToolbarHeight)];</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">_playButton = [[UIImageView alloc] initWithFrame:CGRectMake((frame.size.width - 50)/2, (frame.size.height - GTVideoToolbarHeight - 50)/2, 50, 50)];</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">[self addSubview:(&#123;</span><br><span class="line">_toolbar = [[GTVideoToolbar alloc] initWithFrame:CGRectMake(0, _coverView.bounds.size.height, frame.size.width, GTVideoToolbarHeight)];</span><br><span class="line">            _toolbar;</span><br><span class="line">        &#125;)];</span><br><span class="line">        </span><br></pre></td></tr></table></figure>

<p><img src="https://gitee.com/zhu565615430/images/raw/master/imas/image-20210116152356166.png" alt="image-20210116152356166"></p>
<img src="https://gitee.com/zhu565615430/images/raw/master/imas/image-20210514114233708.png" alt="image-20210514114233708" style="zoom:50%;">
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://example.com/2019/04/17/oc%E7%89%88%E6%9C%AC%E7%9A%84%E6%96%B0%E9%97%BBApp%EF%BC%885%EF%BC%89/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.png">
      <meta itemprop="name" content="zhuguanliang">
      <meta itemprop="description" content=" iOS developer">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="我不是诸葛亮">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2019/04/17/oc%E7%89%88%E6%9C%AC%E7%9A%84%E6%96%B0%E9%97%BBApp%EF%BC%885%EF%BC%89/" class="post-title-link" itemprop="url">oc版本的新闻App（5）</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2019-04-17 12:49:00" itemprop="dateCreated datePublished" datetime="2019-04-17T12:49:00+08:00">2019-04-17</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2021-02-01 14:49:00" itemprop="dateModified" datetime="2021-02-01T14:49:00+08:00">2021-02-01</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="处理点击cell事件"><a href="#处理点击cell事件" class="headerlink" title="处理点击cell事件"></a>处理点击cell事件</h2><img src="https://gitee.com/zhu565615430/images/raw/master/imas/Jan-13-2021%2001-40-05.gif" alt="Jan-13-2021 01-40-05" style="zoom:50%;">

<p><img src="https://gitee.com/zhu565615430/images/raw/master/imas/image-20210113014220012.png" alt="image-20210113014220012"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">- (instancetype)initWithUrlString:(NSString *)urlString;</span><br></pre></td></tr></table></figure>

<p><img src="https://gitee.com/zhu565615430/images/raw/master/imas/image-20210113014258816.png" alt="image-20210113014258816"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">@property (nonatomic, copy, readwrite) NSString *articleUrl;</span><br><span class="line"></span><br><span class="line">- (instancetype)initWithUrlString:(NSString *)urlString &#123;</span><br><span class="line">    self = [super init];</span><br><span class="line">    if (self) &#123;</span><br><span class="line">        self.articleUrl = urlString;</span><br><span class="line">    &#125;</span><br><span class="line">    return self;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">[self.webView loadRequest:[NSURLRequest requestWithURL:[NSURL URLWithString:self.articleUrl]]];</span><br></pre></td></tr></table></figure>

<p><img src="https://gitee.com/zhu565615430/images/raw/master/imas/image-20210113014159927.png"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">#import &quot;GTListItem.h&quot;</span><br><span class="line"></span><br><span class="line">    GTListItem *item = [self.dataArray objectAtIndex:indexPath.row];</span><br><span class="line">    GTDetailViewController *controller = [[GTDetailViewController alloc] initWithUrlString:item.articleUrl]; //创建UIViewController</span><br><span class="line">    </span><br><span class="line">    </span><br></pre></td></tr></table></figure>

<p>文件管理1</p>
<p><img src="https://gitee.com/zhu565615430/images/raw/master/imas/image-20210113113551483.png" alt="image-20210113113551483"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[self _getSandBoxPath];</span><br><span class="line"></span><br><span class="line">NSArray *pathArray = NSSearchPathForDirectoriesInDomains(NSDocumentDirectory, NSUserDomainMask, YES);</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>文件管理2</p>
<p><img src="https://gitee.com/zhu565615430/images/raw/master/imas/image-20210113120614876.png" alt="image-20210113120614876"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">    NSArray *pathArray = NSSearchPathForDirectoriesInDomains(NSCachesDirectory, NSUserDomainMask, YES);</span><br><span class="line">    NSString *cachePath = [pathArray firstObject];</span><br><span class="line">    </span><br><span class="line">    NSFileManager *fileManager = [NSFileManager defaultManager];</span><br><span class="line">    </span><br><span class="line">    //创建文件夹</span><br><span class="line">    NSString *dataPath = [cachePath stringByAppendingPathComponent:@&quot;GTData&quot;];</span><br><span class="line">    NSError *creatError;</span><br><span class="line">    [fileManager createDirectoryAtPath:dataPath withIntermediateDirectories:YES attributes:nil error:&amp;creatError];</span><br><span class="line">    </span><br><span class="line">    //创建文件</span><br><span class="line">    NSString *listDataPath = [dataPath stringByAppendingPathComponent:@&quot;list&quot;];</span><br><span class="line">    NSData *listData = [@&quot;abc&quot; dataUsingEncoding:NSUTF8StringEncoding];</span><br><span class="line">    [fileManager createFileAtPath:listDataPath contents:listData attributes:nil];</span><br><span class="line">    </span><br><span class="line">    //查询文件</span><br><span class="line">    BOOL fileExist = [fileManager fileExistsAtPath:listDataPath];</span><br><span class="line">    </span><br><span class="line">    //删除</span><br><span class="line">//    if(fileExist)&#123;</span><br><span class="line">//        [fileManager removeItemAtPath:listDataPath error:nil];</span><br><span class="line">//    &#125;</span><br><span class="line">    </span><br><span class="line">        NSFileHandle *fileHandler = [NSFileHandle fileHandleForUpdatingAtPath:listDataPath];</span><br><span class="line">    </span><br><span class="line">        [fileHandler seekToEndOfFile];</span><br><span class="line">        [fileHandler writeData:[@&quot;def&quot; dataUsingEncoding:NSUTF8StringEncoding]];</span><br><span class="line">    </span><br><span class="line">        [fileHandler synchronizeFile];</span><br><span class="line">        [fileHandler closeFile];</span><br></pre></td></tr></table></figure>

<p>序列化和反序列化</p>
<ul>
<li>序列化</li>
</ul>
<p><img src="https://gitee.com/zhu565615430/images/raw/master/imas/image-20210113123538649.png" alt="image-20210113123538649"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">@interface GTListItem : NSObject &lt;NSSecureCoding&gt;</span><br></pre></td></tr></table></figure>

<p><img src="https://gitee.com/zhu565615430/images/raw/master/imas/image-20210113123614149.png" alt="image-20210113123614149"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">#pragma mark - NSSecureCoding</span><br><span class="line"></span><br><span class="line">- (nullable instancetype)initWithCoder:(NSCoder *)aDecoder&#123;</span><br><span class="line">    self = [super init];</span><br><span class="line">    if (self) &#123;</span><br><span class="line">        self.category = [aDecoder decodeObjectForKey:@&quot;category&quot;];</span><br><span class="line">        self.picUrl = [aDecoder decodeObjectForKey:@&quot;picUrl&quot;];</span><br><span class="line">        self.uniqueKey = [aDecoder decodeObjectForKey:@&quot;uniqueKey&quot;];</span><br><span class="line">        self.title = [aDecoder decodeObjectForKey:@&quot;title&quot;];</span><br><span class="line">        self.date = [aDecoder decodeObjectForKey:@&quot;date&quot;];</span><br><span class="line">        self.authorName = [aDecoder decodeObjectForKey:@&quot;authorName&quot;];</span><br><span class="line">        self.articleUrl = [aDecoder decodeObjectForKey:@&quot;articleUrl&quot;];</span><br><span class="line">    &#125;</span><br><span class="line">    return self;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (void)encodeWithCoder:(NSCoder *)aCoder&#123;</span><br><span class="line">    [aCoder encodeObject:self.category forKey:@&quot;category&quot;];</span><br><span class="line">    [aCoder encodeObject:self.picUrl forKey:@&quot;picUrl&quot;];</span><br><span class="line">    [aCoder encodeObject:self.uniqueKey forKey:@&quot;uniqueKey&quot;];</span><br><span class="line">    [aCoder encodeObject:self.title forKey:@&quot;title&quot;];</span><br><span class="line">    [aCoder encodeObject:self.date forKey:@&quot;date&quot;];</span><br><span class="line">    [aCoder encodeObject:self.authorName forKey:@&quot;authorName&quot;];</span><br><span class="line">    [aCoder encodeObject:self.articleUrl forKey:@&quot;articleUrl&quot;];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">+ (BOOL)supportsSecureCoding&#123;</span><br><span class="line">    return YES;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">#pragma mark - public method</span><br></pre></td></tr></table></figure>

<p><img src="https://gitee.com/zhu565615430/images/raw/master/imas/image-20210113123713890.png" alt="image-20210113123713890"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">__weak typeof(self) weakSelf = self;</span><br><span class="line">NSURLSessionDataTask *dataTask = [session dataTaskWithURL:listURL completionHandler:^(NSData *_Nullable data, NSURLResponse *_Nullable response, NSError *_Nullable error) &#123;</span><br><span class="line">    __strong typeof(weakSelf) strongSelf = weakSelf;</span><br></pre></td></tr></table></figure>

<p><img src="https://gitee.com/zhu565615430/images/raw/master/imas/image-20210113123747448.png" alt="image-20210113123747448"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[weakSelf _archiveListDataWithArray:listItemArray.copy];</span><br><span class="line"></span><br><span class="line">- (void)_archiveListDataWithArray:(NSArray&lt;GTListItem *&gt; *)array&#123;</span><br></pre></td></tr></table></figure>

<p><img src="https://gitee.com/zhu565615430/images/raw/master/imas/image-20210113123853783.png" alt="image-20210113123853783"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">NSData *listData = [NSKeyedArchiver archivedDataWithRootObject:array requiringSecureCoding:YES error:nil];</span><br></pre></td></tr></table></figure>

<ul>
<li>序列化</li>
</ul>
<p><img src="https://gitee.com/zhu565615430/images/raw/master/imas/image-20210113124809176.png" alt="image-20210113124809176"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">NSData *readListdata = [fileManager contentsAtPath:listDataPath];</span><br><span class="line">id unarchiveObj = [NSKeyedUnarchiver unarchivedObjectOfClasses:[NSSet setWithObjects:[NSArray class],[GTListItem class], nil]  fromData:readListdata error:nil];</span><br></pre></td></tr></table></figure>

<p>对本地数据进行存取，不用网络请求读取本地数据</p>
<p><img src="https://gitee.com/zhu565615430/images/raw/master/imas/image-20210113162100558.png" alt="image-20210113162100558"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">NSArray&lt;GTListItem *&gt; *listdata = [self _readDataFromLocal];</span><br><span class="line">if (listdata) &#123;</span><br><span class="line">    finishBlock(YES, listdata);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="https://gitee.com/zhu565615430/images/raw/master/imas/image-20210113162135313.png" alt="image-20210113162135313"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">#pragma mark - private method</span><br><span class="line">- (NSArray&lt;GTListItem *&gt; *)_readDataFromLocal&#123;</span><br><span class="line">    </span><br><span class="line">    NSArray *pathArray = NSSearchPathForDirectoriesInDomains(NSCachesDirectory, NSUserDomainMask, YES);</span><br><span class="line">    NSString *cachePath = [pathArray firstObject];</span><br><span class="line">    NSString *listDataPath = [cachePath stringByAppendingPathComponent:@&quot;GTData/list&quot;];</span><br><span class="line"></span><br><span class="line">    NSFileManager *fileManager = [NSFileManager defaultManager];</span><br><span class="line">    </span><br><span class="line">    NSData *readListData = [fileManager contentsAtPath:listDataPath];</span><br><span class="line"></span><br><span class="line">    id unarchiveObj = [NSKeyedUnarchiver unarchivedObjectOfClasses:[NSSet setWithObjects:[NSArray class],[GTListItem class], nil]  fromData:readListData error:nil];</span><br><span class="line">    </span><br><span class="line">    if ([unarchiveObj isKindOfClass:[NSArray class]] &amp;&amp; [unarchiveObj count] &gt; 0) &#123;</span><br><span class="line">        return (NSArray&lt;GTListItem *&gt; *)unarchiveObj;</span><br><span class="line">    &#125;</span><br><span class="line">    return nil;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="https://gitee.com/zhu565615430/images/raw/master/imas/image-20210113162217510.png" alt="image-20210113162217510"></p>
<p><img src="https://gitee.com/zhu565615430/images/raw/master/imas/image-20210113162232089.png" alt="image-20210113162232089"></p>
<p>新闻已读状态</p>
<img src="https://gitee.com/zhu565615430/images/raw/master/imas/image-20210113180925781.png" alt="image-20210113180925781" style="zoom:50%;">

<p><img src="https://gitee.com/zhu565615430/images/raw/master/imas/image-20210113180949613.png" alt="image-20210113180949613"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">BOOL hasRead = [[NSUserDefaults standardUserDefaults] boolForKey:item.uniqueKey];</span><br><span class="line"></span><br><span class="line">if (hasRead) &#123;</span><br><span class="line">    self.titleLabel.textColor = [UIColor lightGrayColor];</span><br><span class="line">&#125;else&#123;</span><br><span class="line">    self.titleLabel.textColor = [UIColor blackColor];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="https://gitee.com/zhu565615430/images/raw/master/imas/image-20210113181045405.png" alt="image-20210113181045405"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[[NSUserDefaults standardUserDefaults] setBool:**YES** forKey:item.uniqueKey];</span><br></pre></td></tr></table></figure>

<h2 id="NSthread多线程的运用"><a href="#NSthread多线程的运用" class="headerlink" title="NSthread多线程的运用"></a>NSthread多线程的运用</h2><p><img src="https://gitee.com/zhu565615430/images/raw/master/imas/image-20210113201033452.png" alt="image-20210113201033452"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">NSThread *downloadImageThread = [[NSThread alloc] initWithBlock:^&#123;</span><br><span class="line">   UIImage *image = [UIImage imageWithData:[NSData dataWithContentsOfURL:[NSURL URLWithString:item.picUrl]]];</span><br><span class="line">   self.rightImageView.image = image;</span><br><span class="line">    </span><br><span class="line">&#125;];</span><br><span class="line">downloadImageThread.name = @&quot;downloadImageThread&quot;;</span><br><span class="line">[downloadImageThread start];</span><br></pre></td></tr></table></figure>

<p>运行程序发现流畅了很多，接下来把非主线程的下载执行结束跳转到主线程来</p>
<h2 id="GCD"><a href="#GCD" class="headerlink" title="GCD"></a>GCD</h2><p><img src="https://gitee.com/zhu565615430/images/raw/master/imas/image-20210113203200018.png" alt="image-20210113203200018"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">dispatch_queue_global_t downloadQueue = dispatch_get_global_queue(DISPATCH_QUEUE_PRIORITY_DEFAULT, 0);//非主队列</span><br><span class="line">dispatch_queue_main_t mainQueue = dispatch_get_main_queue();//主队列</span><br><span class="line">    </span><br><span class="line">dispatch_async(downloadQueue, ^&#123;//非主队列执行</span><br><span class="line">    UIImage *image = [UIImage imageWithData:[NSData dataWithContentsOfURL:[NSURL URLWithString:item.picUrl]]];</span><br><span class="line">    dispatch_async(mainQueue, ^&#123;//主队列执行</span><br><span class="line">        self.rightImageView.image = image;</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<h2 id="图片下载与存储"><a href="#图片下载与存储" class="headerlink" title="图片下载与存储"></a>图片下载与存储</h2><p><img src="https://gitee.com/zhu565615430/images/raw/master/imas/image-20210113214847064.png" alt="image-20210113214847064"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">#import &quot;SDWebImage.h&quot;</span><br></pre></td></tr></table></figure>

<p><img src="https://gitee.com/zhu565615430/images/raw/master/imas/image-20210113214931232.png" alt="image-20210113214931232"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">[self.rightImageView sd_setImageWithURL:[NSURL URLWithString:item.picUrl]</span><br><span class="line">                              completed:^(UIImage * _Nullable image, NSError * _Nullable error, SDImageCacheType cacheType, NSURL * _Nullable imageURL) &#123;</span><br><span class="line">                                    //处理业务逻辑，通过cacheType判断图片是否命中缓存</span><br><span class="line">    NSLog(@&quot;&quot;);</span><br><span class="line">                              &#125;];</span><br></pre></td></tr></table></figure>
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://example.com/2019/04/16/oc%E7%89%88%E6%9C%AC%E7%9A%84%E6%96%B0%E9%97%BBApp%EF%BC%884%EF%BC%89/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.png">
      <meta itemprop="name" content="zhuguanliang">
      <meta itemprop="description" content=" iOS developer">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="我不是诸葛亮">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2019/04/16/oc%E7%89%88%E6%9C%AC%E7%9A%84%E6%96%B0%E9%97%BBApp%EF%BC%884%EF%BC%89/" class="post-title-link" itemprop="url">oc版本的新闻App（4）</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2019-04-16 12:49:00" itemprop="dateCreated datePublished" datetime="2019-04-16T12:49:00+08:00">2019-04-16</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2021-02-01 14:49:00" itemprop="dateModified" datetime="2021-02-01T14:49:00+08:00">2021-02-01</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="代码规范和重构"><a href="#代码规范和重构" class="headerlink" title="代码规范和重构"></a>代码规范和重构</h2><p>点击右键rename重命名ViewController为GTNewsViewController</p>
<p><img src="https://gitee.com/zhu565615430/images/raw/master/imas/image-20210513234126736.png" alt="image-20210513234126736"></p>
<p>同时修改</p>
<p><img src="https://gitee.com/zhu565615430/images/raw/master/imas/image-20210111171546625.png" alt="image-20210111171546625"></p>
<h2 id="网络请求的实现"><a href="#网络请求的实现" class="headerlink" title="网络请求的实现"></a>网络请求的实现</h2><h3 id="新建GTListLoader"><a href="#新建GTListLoader" class="headerlink" title="新建GTListLoader"></a>新建GTListLoader</h3><img src="https://gitee.com/zhu565615430/images/raw/master/imas/image-20210111224114783.png" style="zoom:33%;">

<img src="https://gitee.com/zhu565615430/images/raw/master/imas/image-20210111225652135.png" alt="image-20210111225652135" style="zoom:33%;">

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">#import &lt;Foundation/Foundation.h&gt;</span><br><span class="line"></span><br><span class="line">NS_ASSUME_NONNULL_BEGIN</span><br><span class="line"></span><br><span class="line">@interface GTListLoader : NSObject</span><br><span class="line"></span><br><span class="line">- (void)loadListData;</span><br><span class="line"></span><br><span class="line">@end</span><br><span class="line"></span><br><span class="line">NS_ASSUME_NONNULL_END</span><br></pre></td></tr></table></figure>

<p><img src="https://gitee.com/zhu565615430/images/raw/master/imas/image-20210111225721893.png"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">#import &quot;GTListLoader.h&quot;</span><br><span class="line"></span><br><span class="line">@implementation GTListLoader</span><br><span class="line">- (void)loadListData&#123;</span><br><span class="line">    </span><br><span class="line">    NSString *urlString = @&quot;https://static001.geekbang.org/univer/classes/ios_dev/lession/45/toutiao.json&quot;;</span><br><span class="line">    NSURL *listURL = [NSURL URLWithString:urlString];</span><br><span class="line">    </span><br><span class="line">    NSLog(@&quot;&quot;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">@end</span><br></pre></td></tr></table></figure>

<p><img src="https://gitee.com/zhu565615430/images/raw/master/imas/image-20210111225826804.png" alt="image-20210111225826804"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line">#import &quot;GTListLoader.h&quot;</span><br><span class="line"></span><br><span class="line">@interface GTNewsViewController()&lt;UITableViewDataSource,UITableViewDelegate,GTNormalTableViewCellDelegate&gt;</span><br><span class="line">@property(nonatomic,strong,readwrite) UITableView *tableView;</span><br><span class="line">@property(nonatomic,strong,readwrite) NSMutableArray *dataArray;</span><br><span class="line">@property(nonatomic,strong,readwrite) GTListLoader *listLoader;;</span><br><span class="line"></span><br><span class="line">@end</span><br><span class="line"></span><br><span class="line">@implementation GTNewsViewController</span><br><span class="line"></span><br><span class="line">- (instancetype)init&#123;</span><br><span class="line">    self = [super init];</span><br><span class="line">    if(self)&#123;</span><br><span class="line">        _dataArray = @[].mutableCopy;</span><br><span class="line">        for(int i = 0;i&lt;20;i++)&#123;</span><br><span class="line">            [_dataArray addObject:@(i)];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    return self;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (void)viewDidLoad &#123;</span><br><span class="line">    [super viewDidLoad];</span><br><span class="line">    self.view.backgroundColor = [UIColor whiteColor];</span><br><span class="line">    </span><br><span class="line">    _tableView  = [[UITableView alloc] initWithFrame:self.view.bounds];</span><br><span class="line">    _tableView.dataSource = self;</span><br><span class="line">    _tableView.delegate = self;</span><br><span class="line">    </span><br><span class="line">    [self.view addSubview:_tableView];</span><br><span class="line">    </span><br><span class="line">    self.listLoader = [[GTListLoader alloc] init];</span><br><span class="line">    [self.listLoader loadListData];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="创建NSURLSession"><a href="#创建NSURLSession" class="headerlink" title="创建NSURLSession"></a>创建NSURLSession</h3><ul>
<li><p>将Request封装成Task</p>
<p><img src="https://gitee.com/zhu565615430/images/raw/master/imas/image-20210111231356664.png" alt="image-20210111231356664"></p>
</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">    __unused NSURLRequest *listRequest = [NSURLRequest requestWithURL:listURL];</span><br><span class="line">    </span><br><span class="line">    NSURLSession *session = [NSURLSession sharedSession];</span><br><span class="line">//    创建Task</span><br><span class="line">    NSURLSessionDataTask *dataTask = [session dataTaskWithURL:listRequest];</span><br></pre></td></tr></table></figure>



<h3 id="系统-NSURLSession-加载数据流程"><a href="#系统-NSURLSession-加载数据流程" class="headerlink" title="系统 NSURLSession 加载数据流程"></a>系统 NSURLSession 加载数据流程</h3><ol>
<li><h4 id="创建-amp-使⽤默认-Session"><a href="#创建-amp-使⽤默认-Session" class="headerlink" title="创建 &amp; 使⽤默认 Session"></a>创建 &amp; 使⽤默认 Session</h4></li>
<li><h4 id="通过地址和参数创建-Task"><a href="#通过地址和参数创建-Task" class="headerlink" title="通过地址和参数创建 Task"></a>通过地址和参数创建 Task</h4></li>
<li><h4 id="开始-amp-取消-Task"><a href="#开始-amp-取消-Task" class="headerlink" title="开始 &amp; 取消 Task"></a>开始 &amp; 取消 Task</h4></li>
<li><h4 id="在-Handler-中处理数据"><a href="#在-Handler-中处理数据" class="headerlink" title="在 Handler 中处理数据"></a>在 Handler 中处理数据</h4></li>
</ol>
<p><img src="https://gitee.com/zhu565615430/images/raw/master/imas/image-20210111232445593.png" alt="image-20210111232445593"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">    NSString *urlString = @&quot;https://static001.geekbang.org/univer/classes/ios_dev/lession/45/toutiao.json&quot;;</span><br><span class="line">    NSURL *listURL = [NSURL URLWithString:urlString];</span><br><span class="line">    </span><br><span class="line">//    __unused NSURLRequest *listRequest = [NSURLRequest requestWithURL:listURL];</span><br><span class="line">    </span><br><span class="line">    NSURLSession *session = [NSURLSession sharedSession];</span><br><span class="line">//    创建Task</span><br><span class="line">    NSURLSessionDataTask *dataTask = [session dataTaskWithURL:listURL completionHandler:^(NSData *_Nullable data, NSURLResponse *_Nullable response, NSError *_Nullable error) &#123;</span><br><span class="line">        </span><br><span class="line">    &#125;];</span><br><span class="line">    </span><br><span class="line">    [dataTask resume];</span><br></pre></td></tr></table></figure>

<p>进行http请求的加载设置</p>
<p><img src="https://gitee.com/zhu565615430/images/raw/master/imas/image-20210111232641849.png" alt="image-20210111232641849"></p>
<p><img src="https://gitee.com/zhu565615430/images/raw/master/imas/image-20210111233150145.png" alt="image-20210111233150145"></p>
<p>可见收到了网络请求response数据</p>
<p>下载集成第三发库cocoapods</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">target &#x27;SampleApp&#x27; do</span><br><span class="line"></span><br><span class="line">pod &quot;AFNetworking&quot;</span><br><span class="line"></span><br><span class="line">end</span><br></pre></td></tr></table></figure>



<p><img src="https://gitee.com/zhu565615430/images/raw/master/imas/image-20210112002424906.png" alt="image-20210112002424906"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">#import &lt;AFNetworking.h&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        NSError *jsonError;</span><br><span class="line">        id jsonObj = [NSJSONSerialization JSONObjectWithData:data options:0 error:&amp;jsonError];</span><br><span class="line">    </span><br><span class="line">        NSLog(@&quot;&quot;);</span><br></pre></td></tr></table></figure>

<p>构造mvc模式，新建GTListItem</p>
<h3 id="列表结构化数组"><a href="#列表结构化数组" class="headerlink" title="列表结构化数组"></a><img src="https://gitee.com/zhu565615430/images/raw/master/imas/image-20210112164633213.png" alt="image-20210112164633213" style="zoom:50%;"><img src="https://gitee.com/zhu565615430/images/raw/master/imas/image-20210112164755493.png" alt="image-20210112164755493">列表结构化数组</h3><p><img src="https://gitee.com/zhu565615430/images/raw/master/imas/image-20210112170551661.png" alt="image-20210112170551661"></p>
<p><img src="https://gitee.com/zhu565615430/images/raw/master/imas/image-20210112170655021.png" alt="image-20210112170655021"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">///  列表结构化数据</span><br><span class="line">@interface GTListItem : NSObject</span><br><span class="line"></span><br><span class="line">@property(nonatomic, copy, readwrite) NSString *category;</span><br><span class="line">@property(nonatomic, copy, readwrite) NSString *picUrl;</span><br><span class="line">@property(nonatomic, copy, readwrite) NSString *uniqueKey;</span><br><span class="line">@property(nonatomic, copy, readwrite) NSString *title;</span><br><span class="line">@property(nonatomic, copy, readwrite) NSString *date;</span><br><span class="line">@property(nonatomic, copy, readwrite) NSString *authorName;</span><br><span class="line">@property(nonatomic, copy, readwrite) NSString *articleUrl;</span><br><span class="line"></span><br><span class="line">//构造函数</span><br><span class="line">- (void)configWithDictionary:(NSDictionary *)dictionary;</span><br></pre></td></tr></table></figure>

<p><img src="https://gitee.com/zhu565615430/images/raw/master/imas/image-20210112170735121.png" alt="image-20210112170735121"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">- (void)configWithDictionary:(NSDictionary *)dictionary &#123;</span><br><span class="line">     #warning 注意类型是否匹配</span><br><span class="line">    self.category = [dictionary objectForKey:@&quot;category&quot;];</span><br><span class="line">    self.picUrl = [dictionary objectForKey:@&quot;thumbnail_pic_s&quot;];</span><br><span class="line">    self.uniqueKey = [dictionary objectForKey:@&quot;uniquekey&quot;];</span><br><span class="line">    self.title = [dictionary objectForKey:@&quot;title&quot;];</span><br><span class="line">    self.date = [dictionary objectForKey:@&quot;date&quot;];</span><br><span class="line">    self.authorName = [dictionary objectForKey:@&quot;author_name&quot;];</span><br><span class="line">    self.articleUrl = [dictionary objectForKey:@&quot;url&quot;];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="https://gitee.com/zhu565615430/images/raw/master/imas/image-20210112170853473.png" alt="image-20210112170853473"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">#import &quot;GTListItem.h&quot;</span><br><span class="line"></span><br><span class="line">@implementation GTListLoader</span><br><span class="line">- (void)loadListData&#123;</span><br><span class="line"></span><br><span class="line">    NSString *urlString = @&quot;http://v.juhe.cn/toutiao/index?type=keji&amp;key=9b36e7f06020e794a3547c5718bc114c&quot;;</span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">#warning 注意类型的检查</span><br><span class="line">        NSArray *dataArray =  [((NSDictionary *)[((NSDictionary *)jsonObj) objectForKey:@&quot;result&quot;]) objectForKey:@&quot;data&quot;];</span><br><span class="line">        NSMutableArray *listItemArray = @[].mutableCopy;</span><br><span class="line">        for (NSDictionary *info in dataArray) &#123;</span><br><span class="line">            GTListItem *listItem = [[GTListItem alloc] init];</span><br><span class="line">            [listItem configWithDictionary:info];</span><br><span class="line">            [listItemArray addObject:listItem];</span><br><span class="line">        &#125;    </span><br></pre></td></tr></table></figure>

<h3 id="结构化数据"><a href="#结构化数据" class="headerlink" title="结构化数据"></a>结构化数据</h3><p><img src="https://gitee.com/zhu565615430/images/raw/master/imas/image-20210112171910981.png"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">@class GTListItem;//声明GTListItem</span><br><span class="line"></span><br><span class="line">NS_ASSUME_NONNULL_BEGIN</span><br><span class="line"></span><br><span class="line">typedef void(^GTListLoaderFinishBlock)(BOOL success, NSArray&lt;GTListItem *&gt; *dataArray);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">/// 列表请求</span><br><span class="line">@interface GTListLoader : NSObject</span><br><span class="line"></span><br><span class="line">- (void)loadListDataWithFinishBlock:(GTListLoaderFinishBlock)finishBlock;</span><br></pre></td></tr></table></figure>

<p><img src="https://gitee.com/zhu565615430/images/raw/master/imas/image-20210112173008596.png" alt="image-20210112173008596"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">@class GTListItem;//声明GTListItem</span><br><span class="line"></span><br><span class="line">NS_ASSUME_NONNULL_BEGIN</span><br><span class="line"></span><br><span class="line">typedef void(^GTListLoaderFinishBlock)(BOOL success, NSArray&lt;GTListItem *&gt; *dataArray);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">/// 列表请求</span><br><span class="line">@interface GTListLoader : NSObject</span><br><span class="line"></span><br><span class="line">- (void)loadListDataWithFinishBlock:(GTListLoaderFinishBlock)finishBlock;</span><br></pre></td></tr></table></figure>

<p><img src="https://gitee.com/zhu565615430/images/raw/master/imas/image-20210112173109912.png" alt="image-20210112173109912"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">- (void)loadListDataWithFinishBlock:(GTListLoaderFinishBlock)finishBlock&#123;</span><br></pre></td></tr></table></figure>

<p><img src="https://gitee.com/zhu565615430/images/raw/master/imas/image-20210112173141243.png" alt="image-20210112173141243"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">dispatch_async(dispatch_get_main_queue(), ^&#123;//将整个回调放到主线程中</span><br><span class="line">               if (finishBlock) &#123;</span><br><span class="line">                   finishBlock(error == nil, listItemArray.copy);</span><br><span class="line">               &#125;</span><br><span class="line">           &#125;);</span><br></pre></td></tr></table></figure>

<p><img src="https://gitee.com/zhu565615430/images/raw/master/imas/image-20210112173210608.png" alt="image-20210112173210608"></p>
<p><img src="https://gitee.com/zhu565615430/images/raw/master/imas/image-20210112173234447.png" alt="image-20210112173234447"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">__weak typeof(self)wself = self;</span><br><span class="line">[self.listLoader loadListDataWithFinishBlock:^(BOOL success, NSArray&lt;GTListItem *&gt; * _Nonnull dataArray) &#123;</span><br><span class="line">    __strong typeof(wself) strongSelf = wself;</span><br><span class="line">    NSLog(@&quot;&quot;);</span><br><span class="line">&#125;];</span><br></pre></td></tr></table></figure>

<p>将数据展示到首页</p>
<p><img src="https://gitee.com/zhu565615430/images/raw/master/imas/image-20210112192057909.png" alt="image-20210112192057909"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">@class GTListItem;</span><br><span class="line"></span><br><span class="line">/**</span><br><span class="line"> 点击删除按钮</span><br><span class="line"> */</span><br><span class="line">@protocol GTNormalTableViewCellDelegate &lt;NSObject&gt;</span><br><span class="line"></span><br><span class="line">- (void)tableViewCell:(UITableViewCell *)tableViewCell clickDeleteButton:(UIButton *)deleteButton;//实现点击的delegate</span><br><span class="line"></span><br><span class="line">@end</span><br><span class="line"></span><br><span class="line">/**</span><br><span class="line"> 新闻列表cell</span><br><span class="line"> */</span><br><span class="line">@interface GTNormalTableViewCell : UITableViewCell</span><br><span class="line"></span><br><span class="line">@property(nonatomic,weak,readwrite) id&lt;GTNormalTableViewCellDelegate&gt; delegate;//设置tableViewCell属性</span><br><span class="line"></span><br><span class="line">- (void)layoutTableViewCellWithItem:(GTListItem *)item;</span><br></pre></td></tr></table></figure>

<p><img src="https://gitee.com/zhu565615430/images/raw/master/imas/image-20210514105550482.png" alt="image-20210514105550482"></p>
<p><img src="https://gitee.com/zhu565615430/images/raw/master/imas/image-20210112192229358.png" alt="image-20210112192229358"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">#import &quot;GTListItem.h&quot;</span><br><span class="line"></span><br><span class="line">- (void)layoutTableViewCellWithItem:(GTListItem *)item&#123;</span><br><span class="line">    self.titleLable.text = item.title;</span><br><span class="line">    </span><br><span class="line">    self.sourceLable.text = item.authorName;</span><br><span class="line">    [self.sourceLable sizeToFit];</span><br><span class="line">    </span><br><span class="line">    self.commentLable.text = item.category;</span><br><span class="line">    [self.commentLable sizeToFit];</span><br><span class="line">    self.commentLable.frame = CGRectMake(self.sourceLable.frame.origin.x + self.sourceLable.frame.size.width + 15, self.commentLable.frame.origin.y, self.commentLable.frame.size.width, self.commentLable.frame.size.height);</span><br><span class="line">    </span><br><span class="line">    self.timeLable.text = item.date;</span><br><span class="line">    [self.timeLable sizeToFit];</span><br><span class="line">    self.timeLable.frame = CGRectMake(self.commentLable.frame.origin.x + self.commentLable.frame.size.width + 15, self.timeLable.frame.origin.y, self.timeLable.frame.size.width, self.timeLable.frame.size.height);</span><br><span class="line">    </span><br><span class="line">    UIImage *image = [UIImage imageWithData:[NSData dataWithContentsOfURL:[NSURL URLWithString:item.picUrl]]];</span><br><span class="line">    self.rightImageView.image = image;</span><br></pre></td></tr></table></figure>

<p><img src="https://gitee.com/zhu565615430/images/raw/master/imas/image-20210112192343977.png" alt="image-20210112192343977"><img src="https://gitee.com/zhu565615430/images/raw/master/imas/image-20210514105822293.png" alt="image-20210514105822293"></p>
<p><img src="https://gitee.com/zhu565615430/images/raw/master/imas/image-20210112192435863.png" alt="image-20210112192435863"></p>
<p><img src="https://gitee.com/zhu565615430/images/raw/master/imas/image-20210112192726777.png" alt="image-20210112192726777"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">@property(nonatomic,strong,readwrite) NSArray *dataArray;</span><br><span class="line"></span><br><span class="line">        strongSelf.dataArray = dataArray;//strongSelf赋值给dataArray</span><br><span class="line">        [strongSelf.tableView reloadData];//刷新当前列表</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">[cell layoutTableViewCellWithItem:[self.dataArray objectAtIndex:indexPath.row]];</span><br></pre></td></tr></table></figure>

<p><img src="https://gitee.com/zhu565615430/images/raw/master/imas/image-20210113011547060.png" alt="image-20210113011547060"></p>
<p>优化UItableView的布局<img src="https://gitee.com/zhu565615430/images/raw/master/imas/image-20210113012457707.png" alt="image-20210113012457707"></p>
<p><img src="https://gitee.com/zhu565615430/images/raw/master/imas/image-20210113012636350.png" alt="image-20210113012636350"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br></pre></td><td class="code"><pre><span class="line">//</span><br><span class="line">//  GTNormalTableViewCell.m</span><br><span class="line">//  SampleApp</span><br><span class="line">//</span><br><span class="line">//  Created by 朱官亮 on 2021/1/10.</span><br><span class="line">//</span><br><span class="line"></span><br><span class="line">#import &quot;GTNormalTableViewCell.h&quot;</span><br><span class="line">#import &quot;GTListItem.h&quot;</span><br><span class="line"></span><br><span class="line">@interface GTNormalTableViewCell ()</span><br><span class="line"></span><br><span class="line">@property(nonatomic,strong,readwrite) UILabel *titleLabel;</span><br><span class="line">@property(nonatomic,strong,readwrite) UILabel *sourceLabel;</span><br><span class="line">@property(nonatomic,strong,readwrite) UILabel *commentLabel;</span><br><span class="line">@property(nonatomic,strong,readwrite) UILabel *timeLabel;</span><br><span class="line">@property(nonatomic,strong,readwrite) UIImageView *rightImageView;//创建个UIImageView</span><br><span class="line">@property(nonatomic,strong,readwrite) UIButton *deleteButton;//创建个UIImageView</span><br><span class="line">@end</span><br><span class="line"></span><br><span class="line">@implementation GTNormalTableViewCell</span><br><span class="line"></span><br><span class="line">- (instancetype)initWithStyle:(UITableViewCellStyle)style reuseIdentifier:(nullable NSString *)reuseIdentifier&#123;</span><br><span class="line">    self = [super initWithStyle:style reuseIdentifier:reuseIdentifier];</span><br><span class="line">    if(self)&#123;</span><br><span class="line">        [self.contentView addSubview:(&#123;</span><br><span class="line">            self.titleLabel = [[UILabel alloc] initWithFrame:CGRectMake(20, 15, 270, 50)];</span><br><span class="line">            //            self.titleLabel.backgroundColor = [UIColor redColor];</span><br><span class="line">            self.titleLabel.font = [UIFont systemFontOfSize:16];</span><br><span class="line">            self.titleLabel.textColor = [UIColor blackColor];</span><br><span class="line">            self.titleLabel.numberOfLines = 2;</span><br><span class="line">            self.titleLabel.lineBreakMode = NSLineBreakByTruncatingTail;</span><br><span class="line">            self.titleLabel;</span><br><span class="line">        &#125;)];</span><br><span class="line">        </span><br><span class="line">        [self.contentView addSubview:(&#123;</span><br><span class="line">            self.sourceLabel = [[UILabel alloc] initWithFrame:CGRectMake(20, 70, 50, 20)];</span><br><span class="line">            //            self.sourceLabel.backgroundColor = [UIColor redColor];</span><br><span class="line">            self.sourceLabel.font = [UIFont systemFontOfSize:12];</span><br><span class="line">            self.sourceLabel.textColor = [UIColor grayColor];</span><br><span class="line">            self.sourceLabel;</span><br><span class="line">        &#125;)];</span><br><span class="line">        </span><br><span class="line">        [self.contentView addSubview:(&#123;</span><br><span class="line">            self.commentLabel = [[UILabel alloc] initWithFrame:CGRectMake(100, 70, 50, 20)];</span><br><span class="line">            //            self.commentLabel.backgroundColor = [UIColor redColor];</span><br><span class="line">            self.commentLabel.font = [UIFont systemFontOfSize:12];</span><br><span class="line">            self.commentLabel.textColor = [UIColor grayColor];</span><br><span class="line">            self.commentLabel;</span><br><span class="line">        &#125;)];</span><br><span class="line">        </span><br><span class="line">        [self.contentView addSubview:(&#123;</span><br><span class="line">            self.timeLabel = [[UILabel alloc] initWithFrame:CGRectMake(150, 70, 50, 20)];</span><br><span class="line">            //            self.timeLabel.backgroundColor = [UIColor redColor];</span><br><span class="line">            self.timeLabel.font = [UIFont systemFontOfSize:12];</span><br><span class="line">            self.timeLabel.textColor = [UIColor grayColor];</span><br><span class="line">            self.timeLabel;</span><br><span class="line">        &#125;)];</span><br><span class="line">        [self.contentView addSubview:(&#123;</span><br><span class="line">            self.rightImageView = [[UIImageView alloc] initWithFrame:CGRectMake(300, 15, 100, 70)];</span><br><span class="line">            self.rightImageView.backgroundColor = [UIColor redColor];</span><br><span class="line">            self.rightImageView;</span><br><span class="line">        &#125;)];</span><br><span class="line">//        [self.contentView addSubview:(&#123;</span><br><span class="line">//            self.deleteButton = [[UIButton alloc] initWithFrame:CGRectMake(240, 80, 30, 20)];</span><br><span class="line">//            [self.deleteButton setTitle:@&quot;X&quot; forState:UIControlStateNormal];</span><br><span class="line">//            [self.deleteButton setTitle:@&quot;V&quot; forState:UIControlStateHighlighted];</span><br><span class="line">//            [self.deleteButton addTarget:self action:@selector(deleteButtonClick) forControlEvents:UIControlEventTouchUpInside];</span><br><span class="line">//</span><br><span class="line">//            self.deleteButton.layer.cornerRadius = 10;</span><br><span class="line">//            self.deleteButton.layer.masksToBounds = YES;</span><br><span class="line">//</span><br><span class="line">//            self.deleteButton.layer.borderColor = [UIColor lightGrayColor].CGColor;</span><br><span class="line">//            self.deleteButton.layer.borderWidth = 2;</span><br><span class="line">//</span><br><span class="line">//            self.deleteButton;</span><br><span class="line">//        &#125;)];</span><br><span class="line">    &#125;</span><br><span class="line">    return self;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (void)layoutTableViewCellWithItem:(GTListItem *)item&#123;</span><br><span class="line">    self.titleLabel.text = item.title;</span><br><span class="line">    </span><br><span class="line">    self.sourceLabel.text = item.authorName;</span><br><span class="line">    [self.sourceLabel sizeToFit];</span><br><span class="line">    </span><br><span class="line">    self.commentLabel.text = item.category;</span><br><span class="line">    [self.commentLabel sizeToFit];</span><br><span class="line">    self.commentLabel.frame = CGRectMake(self.sourceLabel.frame.origin.x + self.sourceLabel.frame.size.width + 15, self.commentLabel.frame.origin.y, self.commentLabel.frame.size.width, self.commentLabel.frame.size.height);</span><br><span class="line">    </span><br><span class="line">    self.timeLabel.text = item.date;</span><br><span class="line">    [self.timeLabel sizeToFit];</span><br><span class="line">    self.timeLabel.frame = CGRectMake(self.commentLabel.frame.origin.x + self.commentLabel.frame.size.width + 15, self.timeLabel.frame.origin.y, self.timeLabel.frame.size.width, self.timeLabel.frame.size.height);</span><br><span class="line">    </span><br><span class="line">    UIImage *image = [UIImage imageWithData:[NSData dataWithContentsOfURL:[NSURL URLWithString:item.picUrl]]];</span><br><span class="line">    self.rightImageView.image = image;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (void)deleteButtonClick&#123;</span><br><span class="line">    if(self.delegate &amp;&amp; [self.delegate respondsToSelector:@selector(tableViewCell:clickDeleteButton:)])&#123;</span><br><span class="line">        [self.delegate tableViewCell:self clickDeleteButton:self.deleteButton];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">@end</span><br><span class="line"></span><br></pre></td></tr></table></figure>
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://example.com/2019/04/15/oc%E7%89%88%E6%9C%AC%E7%9A%84%E6%96%B0%E9%97%BBApp%EF%BC%883%EF%BC%89/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.png">
      <meta itemprop="name" content="zhuguanliang">
      <meta itemprop="description" content=" iOS developer">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="我不是诸葛亮">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2019/04/15/oc%E7%89%88%E6%9C%AC%E7%9A%84%E6%96%B0%E9%97%BBApp%EF%BC%883%EF%BC%89/" class="post-title-link" itemprop="url">oc版本的新闻App（3）</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2019-04-15 12:49:00" itemprop="dateCreated datePublished" datetime="2019-04-15T12:49:00+08:00">2019-04-15</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2019-04-17 14:49:00" itemprop="dateModified" datetime="2019-04-17T14:49:00+08:00">2019-04-17</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="UIImage-and-UIImageView"><a href="#UIImage-and-UIImageView" class="headerlink" title="UIImage and  UIImageView"></a>UIImage and  UIImageView</h2><h3 id="添加UIImageView"><a href="#添加UIImageView" class="headerlink" title="添加UIImageView"></a>添加UIImageView</h3><p><img src="https://gitee.com/zhu565615430/images/raw/master/imas/image-20210110124325576.png" alt="image-20210110124325576"></p>
<p><img src="https://gitee.com/zhu565615430/images/raw/master/imas/image-20210110124425911.png"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">@property(nonatomic,strong,readwrite) UIImageView *rightImageView;//创建个UIImageView</span><br><span class="line"></span><br><span class="line">        [self.contentView addSubview:(&#123;</span><br><span class="line">            self.rightImageView = [[UIImageView alloc] initWithFrame:CGRectMake(280, 15, 70, 70)];</span><br><span class="line">            self.rightImageView.backgroundColor = [UIColor redColor];</span><br><span class="line">            self.rightImageView;</span><br><span class="line">        &#125;)];</span><br><span class="line">        </span><br><span class="line">        </span><br><span class="line">    self.rightImageView.image = [UIImage imageNamed:@&quot;icon.bundle/timg.jpg&quot;];        </span><br><span class="line">        </span><br><span class="line">        </span><br></pre></td></tr></table></figure>

<img src="https://gitee.com/zhu565615430/images/raw/master/imas/image-20210110124639440.png" alt="image-20210110124639440" style="zoom:33%;">

<h2 id="Add-UIButton、点击和手势"><a href="#Add-UIButton、点击和手势" class="headerlink" title="Add UIButton、点击和手势"></a>Add UIButton、点击和手势</h2><h3 id="添加UIButton"><a href="#添加UIButton" class="headerlink" title="添加UIButton"></a>添加UIButton</h3><p><img src="https://gitee.com/zhu565615430/images/raw/master/imas/image-20210110140959750.png" alt="image-20210110140959750"></p>
<p><img src="https://gitee.com/zhu565615430/images/raw/master/imas/image-20210110141946491.png" alt="image-20210110141946491"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">@property(nonatomic,strong,readwrite) UIButton *deleteButton;//创建个UIImageView</span><br><span class="line"></span><br><span class="line">        [self.contentView addSubview:(&#123;</span><br><span class="line">            self.deleteButton = [[UIButton alloc] initWithFrame:CGRectMake(240, 80, 30, 20)];</span><br><span class="line">            self.deleteButton.backgroundColor = [UIColor blueColor];</span><br><span class="line">            [self.deleteButton setTitle:@&quot;X&quot; forState:UIControlStateNormal];</span><br><span class="line">            [self.deleteButton setTitle:@&quot;V&quot; forState:UIControlStateHighlighted];</span><br><span class="line">            self.deleteButton;</span><br><span class="line">        &#125;)];</span><br></pre></td></tr></table></figure>

<h3 id="UIButton和用户交互相关的逻辑"><a href="#UIButton和用户交互相关的逻辑" class="headerlink" title="UIButton和用户交互相关的逻辑"></a>UIButton和用户交互相关的逻辑</h3><p><img src="https://gitee.com/zhu565615430/images/raw/master/imas/image-20210110143708370.png" alt="image-20210110143708370"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">[self.deleteButton addTarget:self action:@selector(deleteButtonClick) forControlEvents:UIControlEventTouchUpInside];</span><br><span class="line">            </span><br><span class="line">- (void)deleteButtonClick&#123;</span><br><span class="line">    NSLog(@&quot;deleteButtonClick&quot;);</span><br><span class="line">&#125;            </span><br></pre></td></tr></table></figure>



<img src="https://gitee.com/zhu565615430/images/raw/master/imas/image-20210513180546641.png" alt="image-20210513180546641" style="zoom: 33%;">

<h2 id="识别用户在屏幕中的触摸UIGestureRecognizer"><a href="#识别用户在屏幕中的触摸UIGestureRecognizer" class="headerlink" title="识别用户在屏幕中的触摸UIGestureRecognizer"></a>识别用户在屏幕中的触摸UIGestureRecognizer</h2><h3 id="在推荐页面上添加一个view"><a href="#在推荐页面上添加一个view" class="headerlink" title="在推荐页面上添加一个view"></a>在推荐页面上添加一个view</h3><p> <img src="https://gitee.com/zhu565615430/images/raw/master/imas/image-20210110144542154.png" alt="image-20210110144542154"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">[view addSubview:(&#123;</span><br><span class="line">    UIView *view = [[UIView alloc] initWithFrame:CGRectMake(100, 200, 100, 100)];</span><br><span class="line">    view.backgroundColor = [UIColor yellowColor];</span><br><span class="line">    view;</span><br><span class="line">&#125;)];</span><br></pre></td></tr></table></figure>



<img src="https://gitee.com/zhu565615430/images/raw/master/imas/image-20210110144733123.png" alt="image-20210110144733123" style="zoom:50%;">

<h3 id="创建点击的手势，只有点击黄才有反应其他没有"><a href="#创建点击的手势，只有点击黄才有反应其他没有" class="headerlink" title="创建点击的手势，只有点击黄才有反应其他没有"></a>创建点击的手势，只有点击黄才有反应其他没有</h3><p><img src="https://gitee.com/zhu565615430/images/raw/master/imas/image-20210513180857246.png" alt="image-20210513180857246"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">UITapGestureRecognizer *tapGesture = [[UITapGestureRecognizer alloc]</span><br><span class="line">initWithTarget:self action:@selector(viewClick)];</span><br><span class="line">[view addGestureRecognizer:tapGesture];</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">- (void)viewClick&#123;</span><br><span class="line">    NSLog(@&quot;viewClick&quot;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="让其点击无或有反应"><a href="#让其点击无或有反应" class="headerlink" title="让其点击无或有反应"></a>让其点击无或有反应</h3><p><img src="https://gitee.com/zhu565615430/images/raw/master/imas/image-20210513181155791.png" alt="image-20210513181155791"></p>
<p><img src="https://gitee.com/zhu565615430/images/raw/master/imas/image-20210110222003176.png" alt="image-20210110222003176"></p>
<p><img src="https://gitee.com/zhu565615430/images/raw/master/imas/image-20210110221939375.png" alt="image-20210110221939375"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">@interface GTRecommendViewController ()&lt;UIScrollViewDelegate,UIGestureRecognizerDelegate&gt;</span><br><span class="line"></span><br><span class="line">tapGesture.delegate  = self;</span><br><span class="line"></span><br><span class="line">- (BOOL)gestureRecognizerShouldBegin:(UIGestureRecognizer *)gestureRecognizer&#123;</span><br><span class="line">    return YES;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<h2 id="WKWebView-and-Delgate"><a href="#WKWebView-and-Delgate" class="headerlink" title="WKWebView and Delgate"></a>WKWebView and Delgate</h2><h3 id="新建新的ViewController，GTDetailViewController"><a href="#新建新的ViewController，GTDetailViewController" class="headerlink" title="新建新的ViewController，GTDetailViewController"></a>新建新的ViewController，GTDetailViewController</h3><p><img src="https://gitee.com/zhu565615430/images/raw/master/imas/image-20210110223716771.png"></p>
<h3 id="加载WKWebView到点击时显示"><a href="#加载WKWebView到点击时显示" class="headerlink" title="加载WKWebView到点击时显示"></a>加载WKWebView到点击时显示</h3><p><img src="https://gitee.com/zhu565615430/images/raw/master/imas/image-20210513181953592.png" alt="image-20210513181953592"></p>
<p><img src="https://gitee.com/zhu565615430/images/raw/master/imas/image-20210110224918952.png" alt="image-20210110224918952"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">#import &quot;GTDetailViewController.h&quot;</span><br><span class="line"></span><br><span class="line">GTDetailViewController *controller = [[GTDetailViewController alloc]init];</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="GTDetailViewController代码如下"><a href="#GTDetailViewController代码如下" class="headerlink" title="GTDetailViewController代码如下"></a>GTDetailViewController代码如下</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">#import &quot;GTDetailViewController.h&quot;</span><br><span class="line">#import &lt;WebKit/WebKit.h&gt;</span><br><span class="line"></span><br><span class="line">@interface GTDetailViewController ()</span><br><span class="line">@property(nonatomic,strong,readwrite) WKWebView *webView;//添加WebView</span><br><span class="line"></span><br><span class="line">@end</span><br><span class="line"></span><br><span class="line">@implementation GTDetailViewController</span><br><span class="line"></span><br><span class="line">- (void)viewDidLoad &#123;</span><br><span class="line">    [super viewDidLoad];</span><br><span class="line">    // Do any additional setup after loading the view.</span><br><span class="line">    [self.view addSubview:(&#123;</span><br><span class="line">        self.webView = [[WKWebView alloc] initWithFrame:CGRectMake(0, 80, self.view.frame.size.width, self.view.frame.size.height - 88)];</span><br><span class="line">//        self.webView.navigationDelegate = self;</span><br><span class="line">        self.webView;</span><br><span class="line">    &#125;)];</span><br><span class="line">    [self.webView loadRequest:[NSURLRequest requestWithURL:[NSURL URLWithString:@&quot;https://www.thepaper.cn&quot;]]];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">@end</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<p>运行可以加载新闻页面</p>
<img src="https://gitee.com/zhu565615430/images/raw/master/imas/May-13-2021%2018-24-59.gif" alt="May-13-2021 18-24-59" style="zoom:50%;">

<h3 id="Delgate"><a href="#Delgate" class="headerlink" title="Delgate"></a>Delgate</h3><p><img src="https://gitee.com/zhu565615430/images/raw/master/imas/image-20210110230303783.png" alt="image-20210110230303783"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">@interface GTDetailViewController ()&lt;WKNavigationDelegate&gt;</span><br><span class="line"></span><br><span class="line">- (void)webView:(WKWebView *)webView decidePolicyForNavigationAction:(WKNavigationAction *)navigationAction decisionHandler:(void (^)(WKNavigationActionPolicy))decisionHandler&#123;</span><br><span class="line">    NSLog(@&quot; &quot;);</span><br><span class="line">    decisionHandler(WKNavigationActionPolicyAllow);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (void)webView:(WKWebView *)webView didFinishNavigation:(null_unspecified WKNavigation *)navigation&#123;</span><br><span class="line">    NSLog(@&quot;&quot;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="观察者模式"><a href="#观察者模式" class="headerlink" title="观察者模式"></a>观察者模式</h2><h3 id="WebView加载进度的实现-KVO并展示页面加载进度"><a href="#WebView加载进度的实现-KVO并展示页面加载进度" class="headerlink" title="WebView加载进度的实现 KVO并展示页面加载进度"></a>WebView加载进度的实现 KVO并展示页面加载进度</h3><p><img src="https://gitee.com/zhu565615430/images/raw/master/imas/image-20210513182938395.png" alt="image-20210513182938395"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">- (void)dealloc&#123;</span><br><span class="line">    [self.webView removeObserver:self forKeyPath:@&quot;estimatedProgress&quot;];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">    </span><br><span class="line">    [self.webView addObserver:self forKeyPath:@&quot;estimatedProgress&quot; options:NSKeyValueObservingOptionNew context:nil];//监听webView的属性</span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">- (void)observeValueForKeyPath:(nullable NSString *)keyPath ofObject:(nullable id)object change:(nullable NSDictionary&lt;NSKeyValueChangeKey, id&gt; *)change context:(nullable void *)context&#123;</span><br><span class="line">    NSLog(@&quot;&quot;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="给其加上进度的展示条，添加到navigationBar下面"><a href="#给其加上进度的展示条，添加到navigationBar下面" class="headerlink" title="给其加上进度的展示条，添加到navigationBar下面"></a>给其加上进度的展示条，添加到navigationBar下面</h3><p><img src="https://gitee.com/zhu565615430/images/raw/master/imas/image-20210513184602340.png" alt="image-20210513184602340"></p>
<p><img src="https://gitee.com/zhu565615430/images/raw/master/imas/image-20210513220153117.png" alt="image-20210513220153117"></p>
<p><img src="https://gitee.com/zhu565615430/images/raw/master/imas/image-20210513220222054.png" alt="image-20210513220222054"></p>
<pre><code>@property(nonatomic,strong,readwrite) UIProgressView *progressView;//添加进度的展示条

[self.view addSubview:(&#123;
    self.progressView = [[UIProgressView alloc] initWithFrame:CGRectMake(0, 88, self.view.frame.size.width, 50)];
    self.progressView;
&#125;)];

self.progressView.progress = self.webView.estimatedProgress;//设置进度条的值    
</code></pre>
<h3 id="运行程序，进度条加上了"><a href="#运行程序，进度条加上了" class="headerlink" title="运行程序，进度条加上了"></a>运行程序，进度条加上了</h3><img src="https://gitee.com/zhu565615430/images/raw/master/imas/image-20210513220507450.png" alt="image-20210513220507450" style="zoom:50%;">

<h2 id="UIView动画完善界面的交互"><a href="#UIView动画完善界面的交互" class="headerlink" title="UIView动画完善界面的交互"></a>UIView动画完善界面的交互</h2><h2 id><a href="#" class="headerlink" title></a><img src="https://gitee.com/zhu565615430/images/raw/master/imas/image-20210513222550397.png" alt="image-20210513222550397"></h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">@protocol GTNormalTableViewCellDelegate &lt;NSObject&gt;</span><br><span class="line"></span><br><span class="line">- (void)tableViewCell:(UITableViewCell *)tableViewCell clickDeleteButton:(UIButton *)deleteButton;//实现点击的delegate</span><br><span class="line"></span><br><span class="line">@property(nonatomic,weak,readwrite) id&lt;GTNormalTableViewCellDelegate&gt; delegate;//设置tableViewCell属性</span><br></pre></td></tr></table></figure>

<h3 id="点击时的判断"><a href="#点击时的判断" class="headerlink" title="点击时的判断"></a>点击时的判断</h3><p><img src="https://gitee.com/zhu565615430/images/raw/master/imas/image-20210111000814817.png"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">if(self.delegate &amp;&amp; [self.delegate respondsToSelector:@selector(tableViewCell:clickDeleteButton:)])&#123;</span><br><span class="line">     [self.delegate tableViewCell:self clickDeleteButton:self.deleteButton];</span><br><span class="line"> &#125;</span><br></pre></td></tr></table></figure>

<h3 id="设置cell的delegate"><a href="#设置cell的delegate" class="headerlink" title="设置cell的delegate"></a>设置cell的delegate</h3><p><img src="https://gitee.com/zhu565615430/images/raw/master/imas/image-20210111001428136.png" alt="image-20210111001428136"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">@interface ViewController()&lt;UITableViewDataSource,UITableViewDelegate,GTNormalTableViewCellDelegate&gt;</span><br><span class="line"></span><br><span class="line">cell.delegate = self;</span><br><span class="line"></span><br><span class="line">- (void)tableViewCell:(UITableViewCell *)tableViewCell clickDeleteButton:(UIButton *)deleteButton&#123;</span><br><span class="line">    NSLog(@&quot;&quot;);</span><br><span class="line">    </span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure>

<h3 id="新建新的ViewController，GTDeleteCellView"><a href="#新建新的ViewController，GTDeleteCellView" class="headerlink" title="新建新的ViewController，GTDeleteCellView"></a>新建新的ViewController，GTDeleteCellView</h3><p><img src="https://gitee.com/zhu565615430/images/raw/master/imas/image-20210111002601409.png" alt="image-20210111002601409"></p>
<p><img src="https://gitee.com/zhu565615430/images/raw/master/imas/image-20210111004030770.png" alt="image-20210111004030770"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line">#import &quot;GTDeleteCellView.h&quot;</span><br><span class="line"></span><br><span class="line">@interface GTDeleteCellView ()</span><br><span class="line"></span><br><span class="line">@property(nonatomic,strong,readwrite)UIView *backgroudView;</span><br><span class="line">@property(nonatomic,strong,readwrite)UIButton *deleteButton;</span><br><span class="line">@end</span><br><span class="line"></span><br><span class="line">@implementation GTDeleteCellView</span><br><span class="line"></span><br><span class="line">- (instancetype)initWithFrame:(CGRect)frame&#123;</span><br><span class="line">    self = [super initWithFrame:frame];</span><br><span class="line">    if(self)&#123;</span><br><span class="line">        [self addSubview:(&#123;</span><br><span class="line">            _backgroudView = [[UIView alloc] initWithFrame:self.bounds];</span><br><span class="line">            _backgroudView.backgroundColor = [UIColor blackColor];</span><br><span class="line">            _backgroudView.alpha = 0.5;</span><br><span class="line">            _backgroudView;</span><br><span class="line">        &#125;)];</span><br><span class="line">        </span><br><span class="line">        [self addSubview:(&#123;</span><br><span class="line">            _deleteButton = [[UIButton alloc] initWithFrame:CGRectMake(0, 0, 200, 200)];</span><br><span class="line">            [_deleteButton addTarget:self action:@selector(_clickButton) forControlEvents:UIControlEventTouchUpInside];</span><br><span class="line">            _deleteButton.backgroundColor = [UIColor blueColor];</span><br><span class="line">            _deleteButton;</span><br><span class="line">        &#125;)];</span><br><span class="line">    &#125;</span><br><span class="line">    return self;</span><br><span class="line">&#125;</span><br><span class="line">- (void)showDeleteView&#123;</span><br><span class="line">    [[UIApplication sharedApplication].keyWindow addSubview:self];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (void)dismissDeleteView&#123;</span><br><span class="line">    [self removeFromSuperview];</span><br><span class="line">&#125;</span><br><span class="line">-(void)_clickButton&#123;</span><br><span class="line">    [self removeFromSuperview];</span><br><span class="line">&#125;</span><br><span class="line">@end</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><img src="https://gitee.com/zhu565615430/images/raw/master/imas/image-20210111004112971.png" alt="image-20210111004112971"></p>
<p><img src="https://gitee.com/zhu565615430/images/raw/master/imas/image-20210111004230819.png" alt="image-20210111004230819"></p>
<p><img src="https://gitee.com/zhu565615430/images/raw/master/imas/image-20210111004209507.png" alt="image-20210111004209507"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">- (void)showDeleteView;</span><br><span class="line"></span><br><span class="line">#import &quot;GTDeleteCellView.h&quot;</span><br><span class="line"></span><br><span class="line">    GTDeleteCellView *deleteView = [[GTDeleteCellView alloc] initWithFrame:self.view.bounds];</span><br><span class="line">    [deleteView showDeleteView];</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="同时添加个点击的手势"><a href="#同时添加个点击的手势" class="headerlink" title="同时添加个点击的手势"></a>同时添加个点击的手势</h3><p><img src="https://gitee.com/zhu565615430/images/raw/master/imas/image-20210111085725645.png" alt="image-20210111085725645"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[_backgroudView addGestureRecognizer:(&#123;</span><br><span class="line">    UITapGestureRecognizer *tapGesture = [[UITapGestureRecognizer alloc] initWithTarget:self action:@selector(dismissDeleteView)];</span><br><span class="line">    tapGesture;</span><br><span class="line">&#125;)];</span><br></pre></td></tr></table></figure>

<h3 id="现在不用点击蓝筐就关闭，简单动画的实现"><a href="#现在不用点击蓝筐就关闭，简单动画的实现" class="headerlink" title="现在不用点击蓝筐就关闭，简单动画的实现"></a>现在不用点击蓝筐就关闭，简单动画的实现</h3><img src="https://gitee.com/zhu565615430/images/raw/master/imas/May-13-2021%2022-48-31.gif" alt="May-13-2021 22-48-31" style="zoom:67%;">

<h3 id="还可以实现回弹效果"><a href="#还可以实现回弹效果" class="headerlink" title="还可以实现回弹效果"></a>还可以实现回弹效果</h3><img src="https://gitee.com/zhu565615430/images/raw/master/imas/May-13-2021%2023-10-22.gif" alt="May-13-2021 23-10-22" style="zoom:50%;">

<img src="https://gitee.com/zhu565615430/images/raw/master/imas/image-20210513225027078.png" alt="image-20210513225027078" style="zoom:50%;">

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[UIView animateWithDuration:1.f animations:^&#123;</span><br><span class="line">    self.deleteButton.frame = CGRectMake((self.bounds.size.width - 200)/2, (self.bounds.size.height - 200)/2, 200, 200);</span><br><span class="line">&#125;];</span><br></pre></td></tr></table></figure>

<h3 id="点击按钮时跳出修改上边代码为"><a href="#点击按钮时跳出修改上边代码为" class="headerlink" title="点击按钮时跳出修改上边代码为"></a>点击按钮时跳出修改上边代码为</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">    [UIView animateWithDuration:1.f delay:0.f usingSpringWithDamping:0.5 initialSpringVelocity:0.5 options:UIViewAnimationOptionCurveEaseInOut animations:^&#123;</span><br><span class="line">        self.deleteButton.frame = CGRectMake((self.bounds.size.width - 200)/2, (self.bounds.size.height - 200)/2, 200, 200);</span><br><span class="line">    &#125; completion:^(BOOL finished)&#123;</span><br><span class="line">        NSLog(@&quot;&quot;);</span><br><span class="line">    &#125;];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<img src="https://gitee.com/zhu565615430/images/raw/master/imas/May-13-2021%2023-09-41.gif" alt="May-13-2021 23-09-41" style="zoom:50%;">

<p><img src="https://gitee.com/zhu565615430/images/raw/master/imas/image-20210513231446742.png" alt="image-20210513231446742"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">- (void)showDeleteViewFromPoint:(CGPoint)point clickBlock:(dispatch_block_t) clickBlock;</span><br></pre></td></tr></table></figure>

<p><img src="https://gitee.com/zhu565615430/images/raw/master/imas/image-20210111094100708.png" alt="image-20210111094100708"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">CGRect rect = [tableViewCell convertRect:deleteButton.frame toView:nil];</span><br><span class="line">[deleteView showDeleteViewFromPoint:rect.origin clickBlock:^&#123;</span><br><span class="line">    NSLog(@&quot;&quot;);</span><br><span class="line">&#125;];</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><img src="https://gitee.com/zhu565615430/images/raw/master/imas/image-20210111094410655.png" alt="image-20210111094410655"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">@property(nonatomic,copy,readwrite)dispatch_block_t deleteBlock;//加在上面的属性</span><br><span class="line"></span><br><span class="line">- (void)showDeleteViewFromPoint:(CGPoint)point clickBlock:(dispatch_block_t) clickBlock&#123;</span><br><span class="line">    </span><br><span class="line">    _deleteButton.frame  = CGRectMake(point.x, point.y, 0, 0);</span><br><span class="line">    </span><br><span class="line">    _deleteBlock = [clickBlock copy];</span><br><span class="line">    </span><br><span class="line">        if(_deleteBlock)&#123;</span><br><span class="line">        _deleteBlock();</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<h3 id="点蓝删除"><a href="#点蓝删除" class="headerlink" title="点蓝删除"></a>点蓝删除</h3><img src="https://gitee.com/zhu565615430/images/raw/master/imas/May-13-2021%2023-20-39.gif" alt="May-13-2021 23-20-39" style="zoom:50%;">

<p><img src="https://gitee.com/zhu565615430/images/raw/master/imas/image-20210111160033173.png" alt="image-20210111160033173"></p>
<p><img src="https://gitee.com/zhu565615430/images/raw/master/imas/image-20210111160116017.png" alt="image-20210111160116017"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">1</span><br><span class="line">@property(nonatomic,strong,readwrite) UITableView *tableView;</span><br><span class="line">@property(nonatomic,strong,readwrite) NSMutableArray *dataArray;</span><br><span class="line"></span><br><span class="line">2</span><br><span class="line">        _dataArray = @[].mutableCopy;</span><br><span class="line">        for(int i = 0;i&lt;20;i++)&#123;</span><br><span class="line">            [_dataArray addObject:@(i)];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line"> 3  </span><br><span class="line">        _tableView  = [[UITableView alloc] initWithFrame:self.view.bounds];</span><br><span class="line">    _tableView.dataSource = self;</span><br><span class="line">    _tableView.delegate = self;</span><br><span class="line">    </span><br><span class="line">    [self.view addSubview:_tableView];</span><br><span class="line">    </span><br><span class="line"> 4 </span><br><span class="line">        return _dataArray.count;</span><br><span class="line">        </span><br><span class="line"> 5       </span><br><span class="line">    __weak typeof (self) wself = self;</span><br><span class="line">    </span><br><span class="line">    [deleteView showDeleteViewFromPoint:rect.origin clickBlock:^&#123;</span><br><span class="line">        __strong typeof(self)strongSelf = wself;</span><br><span class="line">        [strongSelf.dataArray removeLastObject];</span><br><span class="line">        [strongSelf.tableView deleteRowsAtIndexPaths:@[[strongSelf.tableView indexPathForCell:tableViewCell]] withRowAnimation:UITableViewRowAnimationAutomatic];</span><br></pre></td></tr></table></figure>

<h3 id="使用CAlayer实现圆角"><a href="#使用CAlayer实现圆角" class="headerlink" title="使用CAlayer实现圆角"></a>使用CAlayer实现圆角</h3><h3 id="同时把蓝色代码删掉"><a href="#同时把蓝色代码删掉" class="headerlink" title="同时把蓝色代码删掉"></a>同时把蓝色代码删掉</h3><p><img src="https://gitee.com/zhu565615430/images/raw/master/imas/image-20210111165542181.png" alt="image-20210111165542181"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">self.deleteButton.layer.cornerRadius = 10;</span><br><span class="line">self.deleteButton.layer.masksToBounds = YES;</span><br><span class="line"></span><br><span class="line">self.deleteButton.layer.borderColor = [UIColor lightGrayColor].CGColor;</span><br><span class="line">self.deleteButton.layer.borderWidth = 2;</span><br></pre></td></tr></table></figure>

<p><img src="https://gitee.com/zhu565615430/images/raw/master/imas/image-20210111165614224.png" alt="image-20210111165614224"></p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://example.com/2019/04/14/oc%E7%89%88%E6%9C%AC%E7%9A%84%E6%96%B0%E9%97%BBApp(2)/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.png">
      <meta itemprop="name" content="zhuguanliang">
      <meta itemprop="description" content=" iOS developer">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="我不是诸葛亮">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2019/04/14/oc%E7%89%88%E6%9C%AC%E7%9A%84%E6%96%B0%E9%97%BBApp(2)/" class="post-title-link" itemprop="url">oc版本的新闻App（2）</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2019-04-14 12:49:00" itemprop="dateCreated datePublished" datetime="2019-04-14T12:49:00+08:00">2019-04-14</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2019-04-15 14:49:00" itemprop="dateModified" datetime="2019-04-15T14:49:00+08:00">2019-04-15</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="视频界面的布局"><a href="#视频界面的布局" class="headerlink" title="视频界面的布局"></a>视频界面的布局</h1><h2 id="UITableViewCell的升级版-UIConnetViewCell"><a href="#UITableViewCell的升级版-UIConnetViewCell" class="headerlink" title="UITableViewCell的升级版 UIConnetViewCell"></a>UITableViewCell的升级版 UIConnetViewCell</h2><h3 id="新建新的ViewController，GTVideoViewController"><a href="#新建新的ViewController，GTVideoViewController" class="headerlink" title="新建新的ViewController，GTVideoViewController"></a>新建新的ViewController，GTVideoViewController</h3><img src="https://gitee.com/zhu565615430/images/raw/master/imas/image-20210513160020452.png" alt="image-20210513160020452" style="zoom:67%;">

<img src="https://gitee.com/zhu565615430/images/raw/master/imas/image-20210110032013559.png" alt="image-20210110032013559" style="zoom:50%;">

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">#import &quot;GTVideoViewController.h&quot;</span><br></pre></td></tr></table></figure>

<p><img src="https://gitee.com/zhu565615430/images/raw/master/imas/image-20210513160221026.png" alt="image-20210513160221026"></p>
<h3 id="将视频下的代码剪切了带到GTVideoViewController"><a href="#将视频下的代码剪切了带到GTVideoViewController" class="headerlink" title="将视频下的代码剪切了带到GTVideoViewController"></a>将视频下的代码剪切了带到GTVideoViewController</h3><img src="https://gitee.com/zhu565615430/images/raw/master/imas/image-20210110032752460.png" alt="image-20210110032752460" style="zoom:50%;">

<p>修改的GTVideoViewController代码如下</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">@implementation GTVideoViewController</span><br><span class="line">-(instancetype) init&#123;</span><br><span class="line">    self = [super init];</span><br><span class="line">    if(self)&#123;</span><br><span class="line">        self.tabBarItem.title = @&quot;视频&quot;;</span><br><span class="line">        self.tabBarItem.image = [UIImage imageNamed:@&quot;icon.bundle/video@2x.png&quot;];</span><br><span class="line">        self.tabBarItem.selectedImage = [UIImage imageNamed:@&quot;icon.bundle/video_selected@2x.png&quot;];</span><br><span class="line">    &#125;</span><br><span class="line">    return self;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (void)viewDidLoad &#123;</span><br><span class="line">    [super viewDidLoad];</span><br><span class="line">    self.view.backgroundColor = [UIColor whiteColor];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>



<h3 id="添加上collectionView，并设置200个"><a href="#添加上collectionView，并设置200个" class="headerlink" title="添加上collectionView，并设置200个"></a>添加上collectionView，并设置200个</h3><p><img src="https://gitee.com/zhu565615430/images/raw/master/imas/image-20210110033408490.png" alt="image-20210110033408490"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">@interface GTVideoViewController ()&lt;UICollectionViewDelegate,UICollectionViewDataSource&gt;</span><br><span class="line">@end</span><br></pre></td></tr></table></figure>

<p><img src="https://gitee.com/zhu565615430/images/raw/master/imas/image-20210110033457723.png" alt="image-20210110033457723"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">- (void)viewDidLoad &#123;</span><br><span class="line">    [super viewDidLoad];</span><br><span class="line">    self.view.backgroundColor = [UIColor whiteColor];</span><br><span class="line">    </span><br><span class="line">    UICollectionViewFlowLayout *flowLayout = [[UICollectionViewFlowLayout alloc] init];</span><br><span class="line">    </span><br><span class="line">    UICollectionView *collectionView = [[UICollectionView alloc] initWithFrame:self.view.bounds collectionViewLayout:flowLayout];</span><br><span class="line">    </span><br><span class="line">    collectionView.delegate = self;</span><br><span class="line">    collectionView.dataSource = self;</span><br><span class="line">    </span><br><span class="line">    [collectionView registerClass:[UICollectionViewCell class] forCellWithReuseIdentifier:@&quot;UICollectionViewCell&quot;];//注册重用的cell</span><br><span class="line">    </span><br><span class="line">    [self.view addSubview:collectionView];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (NSInteger)collectionView:(UICollectionView *)collectionView numberOfItemsInSection:(NSInteger)section&#123;</span><br><span class="line">    return 200;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// The cell that is returned must be retrieved from a call to -dequeueReusableCellWithReuseIdentifier:forIndexPath:</span><br><span class="line">- (__kindof UICollectionViewCell *)collectionView:(UICollectionView *)collectionView cellForItemAtIndexPath:(NSIndexPath *)indexPath&#123;</span><br><span class="line">    UICollectionViewCell *cell = [collectionView dequeueReusableCellWithReuseIdentifier:@&quot;UICollectionViewCell&quot; forIndexPath:indexPath];</span><br><span class="line">    cell.backgroundColor = [UIColor redColor];</span><br><span class="line">    return cell;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<img src="https://gitee.com/zhu565615430/images/raw/master/imas/image-20210513162232014.png" alt="image-20210513162232014" style="zoom:50%;">

<h2 id="使用UIcollectionView实现瀑布流效果"><a href="#使用UIcollectionView实现瀑布流效果" class="headerlink" title="使用UIcollectionView实现瀑布流效果"></a>使用UIcollectionView实现瀑布流效果</h2><h3 id="collectionViewlayout的使用"><a href="#collectionViewlayout的使用" class="headerlink" title="collectionViewlayout的使用"></a>collectionViewlayout的使用</h3><p><img src="https://gitee.com/zhu565615430/images/raw/master/imas/image-20210513162320208.png" alt="image-20210513162320208"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">flowLayout.minimumLineSpacing = 10; //行间距</span><br><span class="line">flowLayout.minimumInteritemSpacing = 10;  //item间的间距</span><br><span class="line">flowLayout.itemSize = CGSizeMake((self.view.frame.size.width - 10)/2,300);</span><br></pre></td></tr></table></figure>

<p><img src="https://gitee.com/zhu565615430/images/raw/master/imas/image-20210110105407630.png" alt="image-20210110105407630"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">- (CGSize)collectionView:(UICollectionView *)collectionView layout:(UICollectionViewLayout*)collectionViewLayout sizeForItemAtIndexPath:(NSIndexPath *)indexPath&#123;</span><br><span class="line">    if(indexPath.item %3 ==0)&#123;</span><br><span class="line">        return CGSizeMake(self.view.frame.size.width,100);</span><br><span class="line">    &#125;else&#123;</span><br><span class="line">        return CGSizeMake((self.view.frame.size.width - 10)/2, 300);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<img src="https://gitee.com/zhu565615430/images/raw/master/imas/image-20210513162454102.png" alt="image-20210513162454102" style="zoom: 50%;">

<h1 id="推荐界面布局"><a href="#推荐界面布局" class="headerlink" title="推荐界面布局"></a>推荐界面布局</h1><h2 id="实现多个列表的横向滑动"><a href="#实现多个列表的横向滑动" class="headerlink" title="实现多个列表的横向滑动"></a>实现多个列表的横向滑动</h2><h3 id="新建GTRecommendViewController，用作推进的视图控制器"><a href="#新建GTRecommendViewController，用作推进的视图控制器" class="headerlink" title="新建GTRecommendViewController，用作推进的视图控制器"></a>新建GTRecommendViewController，用作推进的视图控制器</h3><p><img src="https://gitee.com/zhu565615430/images/raw/master/imas/image-20210110105853834.png" alt="image-20210110105853834"></p>
<p>在![image-20210110110027233](/Users/zhuguanliang/Library/Application Support/typora-user-images/image-20210110110027233.png?lastModify=1620831350)</p>
<p>然后它下面替换推荐列表</p>
<p><img src="https://gitee.com/zhu565615430/images/raw/master/imas/image-20210110110450100.png" alt="image-20210110110450100"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">GTRecommendViewController *recimmendController = [[GTRecommendViewController alloc] init];</span><br><span class="line">recimmendController.view.backgroundColor = [UIColor greenColor];</span><br><span class="line">recimmendController.tabBarItem.title = @&quot;推荐&quot;;</span><br><span class="line">recimmendController.tabBarItem.image = [UIImage imageNamed:@&quot;icon.bundle/like@2x.png&quot;];</span><br><span class="line">recimmendController.tabBarItem.selectedImage = [UIImage imageNamed:@&quot;icon.bundle/like_selected@2x.png&quot;];</span><br><span class="line"></span><br><span class="line">[tabbarConttroller setViewControllers:@[viewController,videoController,recimmendController,controller4]];</span><br></pre></td></tr></table></figure>

<p>将相关（绿色部分）逻辑剪切到GTRecommendViewController</p>
<p><img src="https://gitee.com/zhu565615430/images/raw/master/imas/image-20210110110847868.png" alt="image-20210110110847868"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">- (instancetype) init&#123;</span><br><span class="line">    self = [super init];</span><br><span class="line">    if(self)&#123;</span><br><span class="line">        self.tabBarItem.title = @&quot;推荐&quot;;</span><br><span class="line">        self.tabBarItem.image = [UIImage imageNamed:@&quot;icon.bundle/like@2x.png&quot;];</span><br><span class="line">        self.tabBarItem.selectedImage = [UIImage imageNamed:@&quot;icon.bundle/like_selected@2x.png&quot;];</span><br><span class="line">    &#125;</span><br><span class="line">    return self;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    self.view.backgroundColor = [UIColor whiteColor];</span><br></pre></td></tr></table></figure>

<p>推荐页面的ViewController完成</p>
<p>添加UIScrollView到推荐列表中</p>
<img src="https://gitee.com/zhu565615430/images/raw/master/imas/image-20210110111435010.png" alt="image-20210110111435010" style="zoom:50%;">

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">UIScrollView *scrollView = [[UIScrollView alloc] initWithFrame:self.view.bounds];</span><br><span class="line">scrollView.backgroundColor  = [UIColor lightGrayColor];</span><br><span class="line">scrollView.contentSize = CGSizeMake(self.view.bounds.size.width * 5, self.view.bounds.size.height);//底部滚动条</span><br><span class="line">[self.view addSubview:scrollView];</span><br></pre></td></tr></table></figure>

<img src="https://gitee.com/zhu565615430/images/raw/master/imas/image-20210110111525429.png" alt="image-20210110111525429" style="zoom:50%;">

<h3 id="添加颜色翻页效果"><a href="#添加颜色翻页效果" class="headerlink" title="添加颜色翻页效果"></a>添加颜色翻页效果</h3><img src="https://gitee.com/zhu565615430/images/raw/master/imas/image-20210110112029258.png" alt="image-20210110112029258" style="zoom:50%;">

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">NSArray *colorArray = @[[UIColor redColor],[UIColor blueColor],[UIColor yellowColor],[UIColor lightGrayColor],[UIColor grayColor]];</span><br><span class="line">for(int i = 0;i &lt; 5; i++)&#123;</span><br><span class="line">    [scrollView addSubview:(&#123;</span><br><span class="line">        UIView *view = [[UIView alloc] initWithFrame:CGRectMake(scrollView.bounds.size.width * i, 0, scrollView.bounds.size.width, scrollView.bounds.size.height)];</span><br><span class="line">        view.backgroundColor = [colorArray objectAtIndex:i];</span><br><span class="line">        view;</span><br><span class="line">    &#125;)];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">scrollView.pagingEnabled = YES; //翻页效果</span><br></pre></td></tr></table></figure>

<img src="https://gitee.com/zhu565615430/images/raw/master/imas/Jan-10-2021%2011-21-45.gif" alt="Jan-10-2021 11-21-45" style="zoom:50%;">



<h2 id="UIScrollViewDelegate实现复杂逻辑的实现"><a href="#UIScrollViewDelegate实现复杂逻辑的实现" class="headerlink" title="UIScrollViewDelegate实现复杂逻辑的实现"></a>UIScrollViewDelegate实现复杂逻辑的实现</h2><p>![image-20210110113319882](/Users/zhuguanliang/Library/Application Support/typora-user-images/image-20210110113319882.png?lastModify=1620831350)</p>
<p>![image-20210110113336979](/Users/zhuguanliang/Library/Application Support/typora-user-images/image-20210110113336979.png?lastModify=1620831350)</p>
<p>![image-20210110113402825](/Users/zhuguanliang/Library/Application Support/typora-user-images/image-20210110113402825.png?lastModify=1620831350)</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">@interface GTRecommendViewController ()&lt;UIScrollViewDelegate&gt;</span><br><span class="line"></span><br><span class="line">  scrollView.delegate = self;</span><br><span class="line">   </span><br><span class="line">- (void)scrollViewDidScroll:(UIScrollView *)scrollView&#123;</span><br><span class="line">  //   NSLog(@&quot;scrollViewDidScrollv - %@&quot;,@(scrollView.contentOffset.x));</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">// called on start of dragging (may require some time and or distance to move)</span><br><span class="line">- (void)scrollViewWillBeginDragging:(UIScrollView *)scrollView&#123;</span><br><span class="line">  NSLog(@&quot;BeginDragging&quot;);//开始拖拽</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">// called on finger up if the user dragged. decelerate is true if it will continue moving afterwards</span><br><span class="line">- (void)scrollViewDidEndDragging:(UIScrollView *)scrollView willDecelerate:(BOOL)decelerate&#123;</span><br><span class="line">  NSLog(@&quot;EndDragging&quot;);//结束拖拽</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// called on finger up as we are moving</span><br><span class="line">- (void)scrollViewWillBeginDecelerating:(UIScrollView *)scrollView&#123;</span><br><span class="line">   </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// called when scroll view grinds to a halt</span><br><span class="line">- (void)scrollViewDidEndDecelerating:(UIScrollView *)scrollView&#123;</span><br><span class="line">   </span><br><span class="line">&#125;    </span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>进行拖拽，控制台输出信息</p>
<img src="https://gitee.com/zhu565615430/images/raw/master/imas/image-20210513164510481.png" alt="image-20210513164510481" style="zoom: 50%;">



<h2 id="scrollViewDidScroll也包含于UITableView，可以使用监测滚动"><a href="#scrollViewDidScroll也包含于UITableView，可以使用监测滚动" class="headerlink" title="scrollViewDidScroll也包含于UITableView，可以使用监测滚动"></a>scrollViewDidScroll也包含于UITableView，可以使用监测滚动</h2><p><img src="https://gitee.com/zhu565615430/images/raw/master/imas/image-20210110115534052.png" alt="image-20210110115534052"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">-(void)scrollViewDidScroll:(UIScrollView *)scrollView &#123;</span><br><span class="line">  NSLog(@&quot;scrollViewDidScroll&quot;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="iOS中文字的展示：UILabel的使用与布局"><a href="#iOS中文字的展示：UILabel的使用与布局" class="headerlink" title="iOS中文字的展示：UILabel的使用与布局"></a>iOS中文字的展示：UILabel的使用与布局</h2><h3 id="新建新的ViewController，GTNormalTableViewCell"><a href="#新建新的ViewController，GTNormalTableViewCell" class="headerlink" title="新建新的ViewController，GTNormalTableViewCell"></a>新建新的ViewController，GTNormalTableViewCell</h3><img src="https://gitee.com/zhu565615430/images/raw/master/imas/image-20210110120212224.png" alt="image-20210110120212224" style="zoom:50%;">

<p>替换掉</p>
<p><img src="https://gitee.com/zhu565615430/images/raw/master/imas/image-20210110120437124%E7%9A%84%E5%89%AF%E6%9C%AC.png" alt="image-20210110120437124的副本"></p>
<p>删掉之前测试UIView的代码</p>
<p><img src="https://gitee.com/zhu565615430/images/raw/master/imas/image-20210513165634194.png" alt="image-20210513165634194"></p>
<p><img src="https://gitee.com/zhu565615430/images/raw/master/imas/image-20210110120619688.png" alt="image-20210110120619688"></p>
<p>替换掉系统默认的</p>
<p><img src="https://gitee.com/zhu565615430/images/raw/master/imas/image-20210110120943113.png" alt="image-20210110120943113"></p>
<p>删掉创建的</p>
<p><img src="https://gitee.com/zhu565615430/images/raw/master/imas/image-20210110121145883.png" alt="image-20210110121145883"></p>
<h2 id="2-在GTNormalTableViewCell创建自己的UIlabel"><a href="#2-在GTNormalTableViewCell创建自己的UIlabel" class="headerlink" title="2.在GTNormalTableViewCell创建自己的UIlabel"></a>2.在GTNormalTableViewCell创建自己的UIlabel</h2><p><img src="https://gitee.com/zhu565615430/images/raw/master/imas/image-20210110121849320.png" alt="image-20210110121849320"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line">#import &quot;GTNormalTableViewCell.h&quot;</span><br><span class="line"></span><br><span class="line">@interface GTNormalTableViewCell ()</span><br><span class="line"></span><br><span class="line">@property(nonatomic,strong,readwrite) UILabel *titleLable;</span><br><span class="line">@property(nonatomic,strong,readwrite) UILabel *sourceLable;</span><br><span class="line">@property(nonatomic,strong,readwrite) UILabel *commentLable;</span><br><span class="line">@property(nonatomic,strong,readwrite) UILabel *timeLable;</span><br><span class="line"></span><br><span class="line">@end</span><br><span class="line"></span><br><span class="line">@implementation GTNormalTableViewCell</span><br><span class="line"></span><br><span class="line">- (instancetype)initWithStyle:(UITableViewCellStyle)style reuseIdentifier:(nullable NSString *)reuseIdentifier&#123;</span><br><span class="line">    self = [super initWithStyle:style reuseIdentifier:reuseIdentifier];</span><br><span class="line">    if(self)&#123;</span><br><span class="line">        [self.contentView addSubview:(&#123;</span><br><span class="line">            self.titleLable = [[UILabel alloc] initWithFrame:CGRectMake(20, 15, 300, 50)];</span><br><span class="line">            self.titleLable.backgroundColor = [UIColor redColor];</span><br><span class="line">            self.titleLable;</span><br><span class="line">        &#125;)];</span><br><span class="line">        </span><br><span class="line">        [self.contentView addSubview:(&#123;</span><br><span class="line">            self.sourceLable = [[UILabel alloc] initWithFrame:CGRectMake(20, 80, 50, 20)];</span><br><span class="line">            self.sourceLable.backgroundColor = [UIColor redColor];</span><br><span class="line">            self.sourceLable.font = [UIFont systemFontOfSize:12];</span><br><span class="line">            self.sourceLable;</span><br><span class="line">        &#125;)];</span><br><span class="line">        </span><br><span class="line">        [self.contentView addSubview:(&#123;</span><br><span class="line">            self.commentLable = [[UILabel alloc] initWithFrame:CGRectMake(100, 80, 50, 20)];</span><br><span class="line">            self.commentLable.backgroundColor = [UIColor redColor];</span><br><span class="line">            self.commentLable.font = [UIFont systemFontOfSize:12];</span><br><span class="line">            self.commentLable;</span><br><span class="line">        &#125;)];</span><br><span class="line">        </span><br><span class="line">        [self.contentView addSubview:(&#123;</span><br><span class="line">            self.timeLable = [[UILabel alloc] initWithFrame:CGRectMake(150, 80, 50, 20)];</span><br><span class="line">            self.timeLable.backgroundColor = [UIColor redColor];</span><br><span class="line">            self.timeLable.font = [UIFont systemFontOfSize:12];</span><br><span class="line">            self.timeLable;</span><br><span class="line">        &#125;)];</span><br><span class="line">    &#125;</span><br><span class="line">    return self;</span><br><span class="line">&#125;</span><br><span class="line">@end</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>暴露方法</p>
<p><img src="https://gitee.com/zhu565615430/images/raw/master/imas/image-20210110122417837.png" alt="image-20210110122417837"></p>
<p>在每次需要布局的时候调用下</p>
<p><img src="https://gitee.com/zhu565615430/images/raw/master/imas/image-20210110122527253.png" alt="image-20210110122527253"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">- (void)layoutTableViewCell;</span><br><span class="line"></span><br><span class="line">[cell layoutTableViewCell];</span><br></pre></td></tr></table></figure>

<p>改GTNormalTableViewCell的UIlabel样式</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line">- (instancetype)initWithStyle:(UITableViewCellStyle)style reuseIdentifier:(nullable NSString *)reuseIdentifier&#123;</span><br><span class="line">    self = [super initWithStyle:style reuseIdentifier:reuseIdentifier];</span><br><span class="line">    if(self)&#123;</span><br><span class="line">        [self.contentView addSubview:(&#123;</span><br><span class="line">            self.titleLable = [[UILabel alloc] initWithFrame:CGRectMake(20, 15, 300, 50)];</span><br><span class="line">            //            self.titleLable.backgroundColor = [UIColor redColor];</span><br><span class="line">            self.titleLable.font = [UIFont systemFontOfSize:16];</span><br><span class="line">            self.titleLable.textColor = [UIColor blackColor];</span><br><span class="line">            self.titleLable;</span><br><span class="line">        &#125;)];</span><br><span class="line">        </span><br><span class="line">        [self.contentView addSubview:(&#123;</span><br><span class="line">            self.sourceLable = [[UILabel alloc] initWithFrame:CGRectMake(20, 80, 50, 20)];</span><br><span class="line">            //            self.sourceLable.backgroundColor = [UIColor redColor];</span><br><span class="line">            self.sourceLable.font = [UIFont systemFontOfSize:12];</span><br><span class="line">            self.sourceLable.textColor = [UIColor grayColor];</span><br><span class="line">            self.sourceLable;</span><br><span class="line">        &#125;)];</span><br><span class="line">        </span><br><span class="line">        [self.contentView addSubview:(&#123;</span><br><span class="line">            self.commentLable = [[UILabel alloc] initWithFrame:CGRectMake(100, 80, 50, 20)];</span><br><span class="line">            //            self.commentLable.backgroundColor = [UIColor redColor];</span><br><span class="line">            self.commentLable.font = [UIFont systemFontOfSize:12];</span><br><span class="line">            self.commentLable.textColor = [UIColor grayColor];</span><br><span class="line">            self.commentLable;</span><br><span class="line">        &#125;)];</span><br><span class="line">        </span><br><span class="line">        [self.contentView addSubview:(&#123;</span><br><span class="line">            self.timeLable = [[UILabel alloc] initWithFrame:CGRectMake(150, 80, 50, 20)];</span><br><span class="line">            //            self.timeLable.backgroundColor = [UIColor redColor];</span><br><span class="line">            self.timeLable.font = [UIFont systemFontOfSize:12];</span><br><span class="line">            self.timeLable.textColor = [UIColor grayColor];</span><br><span class="line">            self.timeLable;</span><br><span class="line">        &#125;)];</span><br><span class="line">    &#125;</span><br><span class="line">    return self;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (void)layoutTableViewCell&#123;</span><br><span class="line">    self.titleLable.text = @&quot;这里这里这里demo&quot;;</span><br><span class="line">    </span><br><span class="line">    self.sourceLable.text = @&quot;这里demo&quot;;</span><br><span class="line">    [self.sourceLable sizeToFit];</span><br><span class="line">    </span><br><span class="line">    self.commentLable.text = @&quot;1666评论&quot;;</span><br><span class="line">    [self.commentLable sizeToFit];</span><br><span class="line">    self.commentLable.frame = CGRectMake(self.sourceLable.frame.origin.x + self.sourceLable.frame.size.width + 15, self.commentLable.frame.origin.y, self.commentLable.frame.size.width, self.commentLable.frame.size.height);</span><br><span class="line">    </span><br><span class="line">    self.timeLable.text = @&quot;三分钟前&quot;;</span><br><span class="line">    [self.timeLable sizeToFit];</span><br><span class="line">    self.timeLable.frame = CGRectMake(self.commentLable.frame.origin.x + self.commentLable.frame.size.width + 15, self.timeLable.frame.origin.y, self.timeLable.frame.size.width, self.timeLable.frame.size.height);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">@end</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<img src="https://gitee.com/zhu565615430/images/raw/master/imas/image-20210513171239162.png" alt="image-20210513171239162" style="zoom: 33%;">


      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://example.com/2019/04/13/oc%E7%89%88%E6%9C%AC%E7%9A%84%E6%96%B0%E9%97%BBApp(1)/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.png">
      <meta itemprop="name" content="zhuguanliang">
      <meta itemprop="description" content=" iOS developer">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="我不是诸葛亮">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2019/04/13/oc%E7%89%88%E6%9C%AC%E7%9A%84%E6%96%B0%E9%97%BBApp(1)/" class="post-title-link" itemprop="url">oc版本的新闻App（1）</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2019-04-13 12:49:00" itemprop="dateCreated datePublished" datetime="2019-04-13T12:49:00+08:00">2019-04-13</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2019-04-15 14:49:00" itemprop="dateModified" datetime="2019-04-15T14:49:00+08:00">2019-04-15</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p><strong>前言：在这系列文章你可以学到以下</strong></p>
<p>1.熟练使用 UI 组件搭建 App 界面；<br>2.掌握 iOS 开发关键技术模块；<br>3.构建系统的移动开发知识体系；<br>4.具体独立开发完整 App 的能力。</p>
<h1 id="新闻界面的布局"><a href="#新闻界面的布局" class="headerlink" title="新闻界面的布局"></a>新闻界面的布局</h1><h2 id="新建OC项目，导入图片"><a href="#新建OC项目，导入图片" class="headerlink" title="新建OC项目，导入图片"></a>新建OC项目，导入图片</h2><img src="https://gitee.com/zhu565615430/images/raw/master/imas/image-20210513133212522.png" alt="image-20210513133212522" style="zoom:50%;">

<h2 id="在SceneDelegate-m添加TabBar代码"><a href="#在SceneDelegate-m添加TabBar代码" class="headerlink" title="在SceneDelegate.m添加TabBar代码"></a>在SceneDelegate.m添加TabBar代码</h2><img src="https://gitee.com/zhu565615430/images/raw/master/imas/image-20210513133733367.png" alt="image-20210513133733367" style="zoom:50%;">

<p>代码：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line">    self.window = [[UIWindow alloc] initWithWindowScene:(UIWindowScene *)scene];</span><br><span class="line">    </span><br><span class="line">    UITabBarController *tabbarConttroller = [[UITabBarController alloc] init];</span><br><span class="line">    </span><br><span class="line">    UIViewController *controller1 = [[UIViewController alloc] init];</span><br><span class="line">    controller1.view.backgroundColor = [UIColor redColor];</span><br><span class="line">    controller1.tabBarItem.title = @&quot;新闻&quot;;</span><br><span class="line">    controller1.tabBarItem.image = [UIImage imageNamed:@&quot;icon.bundle/page@2x.png&quot;];</span><br><span class="line">    controller1.tabBarItem.selectedImage = [UIImage imageNamed:@&quot;icon.bundle/page_selected@2x.png&quot;];</span><br><span class="line">    </span><br><span class="line"></span><br><span class="line">    UIViewController *controller2 = [[UIViewController alloc] init];</span><br><span class="line">    controller2.view.backgroundColor = [UIColor yellowColor];</span><br><span class="line">    controller2.tabBarItem.title = @&quot;视频&quot;;</span><br><span class="line">    controller2.tabBarItem.image = [UIImage imageNamed:@&quot;icon.bundle/video@2x.png&quot;];</span><br><span class="line">    controller2.tabBarItem.selectedImage = [UIImage imageNamed:@&quot;icon.bundle/video_selected@2x.png&quot;];</span><br><span class="line">    </span><br><span class="line">    UIViewController *controller3 = [[UIViewController alloc] init];</span><br><span class="line">    controller3.view.backgroundColor = [UIColor greenColor];</span><br><span class="line">    controller3.tabBarItem.title = @&quot;推荐&quot;;</span><br><span class="line">    controller3.tabBarItem.image = [UIImage imageNamed:@&quot;icon.bundle/like@2x.png&quot;];</span><br><span class="line">    controller3.tabBarItem.selectedImage = [UIImage imageNamed:@&quot;icon.bundle/like_selected@2x.png&quot;];</span><br><span class="line">    </span><br><span class="line">    UIViewController *controller4 = [[UIViewController alloc] init];</span><br><span class="line">    controller4.view.backgroundColor = [UIColor lightGrayColor];</span><br><span class="line">    controller4.tabBarItem.title = @&quot;我的&quot;;</span><br><span class="line">    controller4.tabBarItem.image = [UIImage imageNamed:@&quot;icon.bundle/home@2x.png&quot;];</span><br><span class="line">    controller4.tabBarItem.selectedImage = [UIImage imageNamed:@&quot;icon.bundle/home_selected@2x.png&quot;];</span><br><span class="line">    </span><br><span class="line">    [tabbarConttroller setViewControllers:@[controller1,controller2,controller3,controller4]];</span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">    self.window.rootViewController = tabbarConttroller;</span><br><span class="line">    [self.window makeKeyAndVisible];</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="使用Navigation-bar进行页面的切换"><a href="#使用Navigation-bar进行页面的切换" class="headerlink" title="使用Navigation bar进行页面的切换"></a>使用Navigation bar进行页面的切换</h2><img src="https://gitee.com/zhu565615430/images/raw/master/imas/Jan-10-2021%2001-32-43.gif" alt="Jan-10-2021 01-32-43" style="zoom:33%;">

<img src="https://gitee.com/zhu565615430/images/raw/master/imas/image-20210110011206498.png" alt="image-20210110011206498" style="zoom:50%;">

<img src="https://gitee.com/zhu565615430/images/raw/master/imas/image-20210110011234873.png" alt="image-20210110011234873" style="zoom:50%;">

<p>代码：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line">   self.window = [[UIWindow alloc] initWithWindowScene:(UIWindowScene *)scene];</span><br><span class="line">    </span><br><span class="line">    UITabBarController *tabbarConttroller = [[UITabBarController alloc] init];</span><br><span class="line">    </span><br><span class="line">    ViewController *viewController = [[ViewController alloc] init];</span><br><span class="line">    UINavigationController *navigationController = [[UINavigationController alloc] initWithRootViewController:viewController];</span><br><span class="line">    </span><br><span class="line">//    UIViewController *controller1 = [[UIViewController alloc] init];</span><br><span class="line">//    controller1.view.backgroundColor = [UIColor redColor];</span><br><span class="line">    navigationController.tabBarItem.title = @&quot;新闻&quot;;</span><br><span class="line">    navigationController.tabBarItem.image = [UIImage imageNamed:@&quot;icon.bundle/page@2x.png&quot;];</span><br><span class="line">    navigationController.tabBarItem.selectedImage = [UIImage imageNamed:@&quot;icon.bundle/page_selected@2x.png&quot;];</span><br><span class="line">    </span><br><span class="line"></span><br><span class="line">    UIViewController *controller2 = [[UIViewController alloc] init];</span><br><span class="line">    controller2.view.backgroundColor = [UIColor yellowColor];</span><br><span class="line">    controller2.tabBarItem.title = @&quot;视频&quot;;</span><br><span class="line">    controller2.tabBarItem.image = [UIImage imageNamed:@&quot;icon.bundle/video@2x.png&quot;];</span><br><span class="line">    controller2.tabBarItem.selectedImage = [UIImage imageNamed:@&quot;icon.bundle/video_selected@2x.png&quot;];</span><br><span class="line">    </span><br><span class="line">    UIViewController *controller3 = [[UIViewController alloc] init];</span><br><span class="line">    controller3.view.backgroundColor = [UIColor greenColor];</span><br><span class="line">    controller3.tabBarItem.title = @&quot;推荐&quot;;</span><br><span class="line">    controller3.tabBarItem.image = [UIImage imageNamed:@&quot;icon.bundle/like@2x.png&quot;];</span><br><span class="line">    controller3.tabBarItem.selectedImage = [UIImage imageNamed:@&quot;icon.bundle/like_selected@2x.png&quot;];</span><br><span class="line">    </span><br><span class="line">    UIViewController *controller4 = [[UIViewController alloc] init];</span><br><span class="line">    controller4.view.backgroundColor = [UIColor lightGrayColor];</span><br><span class="line">    controller4.tabBarItem.title = @&quot;我的&quot;;</span><br><span class="line">    controller4.tabBarItem.image = [UIImage imageNamed:@&quot;icon.bundle/home@2x.png&quot;];</span><br><span class="line">    controller4.tabBarItem.selectedImage = [UIImage imageNamed:@&quot;icon.bundle/home_selected@2x.png&quot;];</span><br><span class="line">    </span><br><span class="line">    [tabbarConttroller setViewControllers:@[navigationController,controller2,controller3,controller4]];</span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">    self.window.rootViewController = tabbarConttroller;</span><br><span class="line">    [self.window makeKeyAndVisible];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="ViewController-m代码修改如下"><a href="#ViewController-m代码修改如下" class="headerlink" title="ViewController.m代码修改如下"></a>ViewController.m代码修改如下</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br></pre></td><td class="code"><pre><span class="line">#import &quot;ViewController.h&quot;</span><br><span class="line"></span><br><span class="line">@interface TestView : UIView</span><br><span class="line">@end</span><br><span class="line"></span><br><span class="line">@implementation TestView</span><br><span class="line"></span><br><span class="line">- (instancetype) init&#123;</span><br><span class="line">    self = [super init];</span><br><span class="line">    if(self)&#123;</span><br><span class="line">        </span><br><span class="line">    &#125;</span><br><span class="line">    return self;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (void)willMoveToSuperview:(nullable UIView *)newSuperview&#123;</span><br><span class="line">    [super willMoveToSuperview:newSuperview];</span><br><span class="line">    </span><br><span class="line">&#125;</span><br><span class="line">- (void)didMoveToSuperview&#123;</span><br><span class="line">    [super didMoveToSuperview];</span><br><span class="line">&#125;</span><br><span class="line">- (void)willMoveToWindow:(nullable UIWindow *)newWindow&#123;</span><br><span class="line">    [super willMoveToWindow:newWindow];</span><br><span class="line">&#125;</span><br><span class="line">- (void)didMoveToWindow&#123;</span><br><span class="line">    [super didMoveToWindow];</span><br><span class="line">    </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">@end</span><br><span class="line"></span><br><span class="line">@interface ViewController()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">@end</span><br><span class="line"></span><br><span class="line">@implementation ViewController</span><br><span class="line"></span><br><span class="line">- (instancetype)init&#123;</span><br><span class="line">    self = [super init];</span><br><span class="line">    if(self)&#123;</span><br><span class="line">        </span><br><span class="line">    &#125;</span><br><span class="line">    return self;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (void)viewWillAppear:(BOOL)animated&#123;</span><br><span class="line">    [super viewWillAppear:animated];</span><br><span class="line">&#125;   // Called when the view is about to made visible. Default does nothing</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">- (void)viewDidAppear:(BOOL)animated&#123;</span><br><span class="line">    [super viewDidAppear:animated];</span><br><span class="line">&#125;    // Called when the view has been fully transitioned onto the screen. Default does nothing</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">- (void)viewWillDisappear:(BOOL)animated&#123;</span><br><span class="line">    [super viewWillDisappear:animated];</span><br><span class="line">&#125; // Called when the view is dismissed, covered or otherwise hidden. Default does nothing</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">- (void)viewDidDisappear:(BOOL)animated&#123;</span><br><span class="line">    [super viewDidDisappear:animated];</span><br><span class="line">&#125;  // Called after the view was dismissed, covered or otherwise hidden. Default does nothing</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">- (void)viewDidLoad &#123;</span><br><span class="line">    [super viewDidLoad];</span><br><span class="line">    self.view.backgroundColor = [UIColor whiteColor];</span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">    // Do any additional setup after loading the view.</span><br><span class="line">//    UIView *view = [[UIView alloc] init];</span><br><span class="line">//    view.backgroundColor = [UIColor redColor];</span><br><span class="line">//    view.frame = CGRectMake(100, 100, 100, 100);</span><br><span class="line">//    [self.view addSubview:view];</span><br><span class="line">    </span><br><span class="line">    TestView *view2 = [[TestView alloc] init];</span><br><span class="line">    view2.backgroundColor = [UIColor greenColor];</span><br><span class="line">    view2.frame = CGRectMake(150, 150, 100, 100);</span><br><span class="line">    [self.view addSubview:view2];</span><br><span class="line">    </span><br><span class="line">//    view 先入栈，view2 后入栈，view2显示在view上</span><br><span class="line">    </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">@end</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="像绿色的View添加新的方法，点击时可以推进新的view黑色页面"><a href="#像绿色的View添加新的方法，点击时可以推进新的view黑色页面" class="headerlink" title="像绿色的View添加新的方法，点击时可以推进新的view黑色页面"></a>像绿色的View添加新的方法，点击时可以推进新的view黑色页面</h2><img src="https://gitee.com/zhu565615430/images/raw/master/imas/May-13-2021%2013-50-41.gif" alt="May-13-2021 13-50-41" style="zoom:67%;">

<p><img src="https://gitee.com/zhu565615430/images/raw/master/imas/image-20210513134615585.png" alt="image-20210513134615585"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">- (void)pushController&#123;</span><br><span class="line">    [self.navigationController pushViewController:[[UIViewController alloc]init] animated:YES];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="同时pull进去时给其添加白色背景，标题"><a href="#同时pull进去时给其添加白色背景，标题" class="headerlink" title="同时pull进去时给其添加白色背景，标题"></a>同时pull进去时给其添加白色背景，标题</h2><img src="https://gitee.com/zhu565615430/images/raw/master/imas/image-20210513134919772.png" alt="image-20210513134919772" style="zoom:50%;">

<p><img src="https://gitee.com/zhu565615430/images/raw/master/imas/image-20210513134854383.png" alt="image-20210513134854383"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">- (void)pushController&#123;</span><br><span class="line">    UIViewController *viewController = [[UIViewController alloc]init];</span><br><span class="line">    viewController.view.backgroundColor = [UIColor whiteColor];</span><br><span class="line">    viewController.navigationItem.title = @&quot;内容&quot;;</span><br><span class="line">    viewController.navigationItem.rightBarButtonItem = [[UIBarButtonItem alloc] initWithTitle:@&quot;右侧标题&quot; style:UIBarButtonItemStylePlain target:self action:nil];</span><br><span class="line">    [self.navigationController pushViewController:viewController animated:YES];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="发现UInavigationController跳转底部TabBar还存在，去掉"><a href="#发现UInavigationController跳转底部TabBar还存在，去掉" class="headerlink" title="发现UInavigationController跳转底部TabBar还存在，去掉"></a>发现UInavigationController跳转底部TabBar还存在，去掉</h2><img src="https://gitee.com/zhu565615430/images/raw/master/imas/Jan-10-2021%2001-50-33.gif" alt="Jan-10-2021 01-50-33" style="zoom:67%;">

<p>后前对比图</p>
<p><img src="https://gitee.com/zhu565615430/images/raw/master/imas/image-20210513135431456.png" alt="image-20210513135431456"></p>
<p><img src="https://gitee.com/zhu565615430/images/raw/master/imas/image-20210513135450625.png" alt="image-20210513135450625"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"> viewController.tabBarItem.title = @&quot;新闻&quot;;</span><br><span class="line"> viewController.tabBarItem.image = [UIImage imageNamed:@&quot;icon.bundle/page@2x.png&quot;];</span><br><span class="line"> viewController.tabBarItem.selectedImage = [UIImage imageNamed:@&quot;icon.bundle/page_selected@2x.png&quot;];</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">[tabbarConttroller setViewControllers:@[viewController,controller2,controller3,controller4]];</span><br><span class="line"> </span><br><span class="line"> UINavigationController *navigationController = [[UINavigationController alloc] initWithRootViewController:tabbarConttroller];</span><br><span class="line"> </span><br><span class="line"> self.window.rootViewController = navigationController;</span><br></pre></td></tr></table></figure>

<h2 id="delegate的使用"><a href="#delegate的使用" class="headerlink" title="delegate的使用"></a>delegate的使用</h2><p>1.先搞清楚谁是谁的代理(delegate)</p>
<p>2.定义代理协议,协议名称的命名规范:控件类名 + Delegate</p>
<p>3.定义代理方法</p>
<p>(1)代理方法一般都定义为@optional</p>
<p>(2)代理方法名都以控件名开头</p>
<p>(3)代理方法至少有1个参数,将控件本身传递出去</p>
<p>4.设置代理(delegate)对象 (比如myView.delegate = xxxx;)</p>
<p>(1)代理对象遵守协议</p>
<p>(2)代理对象实现协议里面该实现的方法</p>
<p>5.在恰当的时刻调用代理对象(delegate)的代理方法,通知代理发生了什么事情</p>
<p>(在调用之前判断代理是否实现了该代理方法)</p>
<p><img src="https://gitee.com/zhu565615430/images/raw/master/imas/image-20210110020518246.png" alt="image-20210110020518246"></p>
<img src="https://gitee.com/zhu565615430/images/raw/master/imas/image-20210110020538062.png" alt="image-20210110020538062">

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">@interface SceneDelegate ()&lt;UITabBarControllerDelegate&gt;</span><br><span class="line"></span><br><span class="line">    tabbarConttroller.delegate = self;</span><br><span class="line"></span><br><span class="line">- (void)tabBarController:(UITabBarController *)tabBarController didSelectViewController:(UIViewController *)viewController&#123;</span><br><span class="line">    NSLog(@&quot;did select&quot;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="创建列表"><a href="#创建列表" class="headerlink" title="创建列表"></a>创建列表</h3><img src="https://gitee.com/zhu565615430/images/raw/master/imas/image-20210513144410274.png" alt="image-20210513144410274" style="zoom:67%;">

<ul>
<li>把UI的逻辑删除掉，简单添加个UITableView</li>
</ul>
<p><img src="https://gitee.com/zhu565615430/images/raw/master/imas/image-20210513142234919.png" alt="image-20210513142234919"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">UITableView *tableView = [[UITableView alloc] initWithFrame:self.view.bounds];</span><br><span class="line">   [self.view addSubview:tableView];</span><br></pre></td></tr></table></figure>

<h3 id="同时添加一些数据"><a href="#同时添加一些数据" class="headerlink" title="同时添加一些数据"></a>同时添加一些数据</h3><p><img src="https://gitee.com/zhu565615430/images/raw/master/imas/image-20210513142837236.png" alt="image-20210513142837236"></p>
<p><img src="https://gitee.com/zhu565615430/images/raw/master/imas/image-20210513142846489.png" alt="image-20210513142846489"></p>
<p>代码如下：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">@interface ViewController()&lt;UITableViewDataSource&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    UITableView *tableView = [[UITableView alloc] initWithFrame:self.view.bounds];</span><br><span class="line">    tableView.dataSource = self;</span><br><span class="line">    </span><br><span class="line">    [self.view addSubview:tableView];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (NSInteger)tableView:(UITableView *)tableView numberOfRowsInSection:(NSInteger)section&#123;</span><br><span class="line">    return 20;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath&#123;</span><br><span class="line">    UITableViewCell *cell = [[UITableViewCell alloc] initWithStyle:UITableViewCellStyleSubtitle reuseIdentifier:@&quot;id&quot;];</span><br><span class="line">    cell.textLabel.text = @&quot;主标题&quot;;</span><br><span class="line">    cell.detailTextLabel.text = @&quot;副标题&quot;;</span><br><span class="line">    cell.imageView.image = [UIImage imageNamed:@&quot;icon.bundle/video&quot;];</span><br><span class="line">    return cell;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="UITableView-delegate-datasource"><a href="#UITableView-delegate-datasource" class="headerlink" title="UITableView delegate datasource"></a>UITableView delegate datasource</h3><p><img src="https://gitee.com/zhu565615430/images/raw/master/imas/image-20210513144730048.png" alt="image-20210513144730048"></p>
<p><img src="https://gitee.com/zhu565615430/images/raw/master/imas/image-20210513144747822.png" alt="image-20210513144747822"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">@interface ViewController()&lt;UITableViewDataSource,UITableViewDelegate&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    tableView.delegate = self;</span><br><span class="line">    </span><br><span class="line">    [self.view addSubview:tableView];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (CGFloat)tableView:(UITableView *)tableView heightForRowAtIndexPath:(NSIndexPath *)indexPath&#123;</span><br><span class="line">    return 100;//高度</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (void)tableView:(UITableView *)tableView didSelectRowAtIndexPath:(NSIndexPath *)indexPath&#123;</span><br><span class="line">    UIViewController *controller = [[UIViewController alloc]init]; //创建UIViewController</span><br><span class="line">    controller.title = [NSString stringWithFormat:@&quot;%@&quot;,@(indexPath.row)];//设置标题，第几个显示第几</span><br><span class="line">    [self.navigationController pushViewController:controller animated:YES];//推进新页面</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (NSInteger)tableView:(UITableView *)tableView numberOfRowsInSection:(NSInteger)section&#123;</span><br><span class="line">    return 20;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath&#123;</span><br><span class="line">    UITableViewCell *cell = [tableView dequeueReusableCellWithIdentifier:@&quot;id&quot;];</span><br><span class="line">    </span><br><span class="line">    if(!cell)&#123;</span><br><span class="line">        cell = [[UITableViewCell alloc] initWithStyle:UITableViewCellStyleSubtitle reuseIdentifier:@&quot;id&quot;];</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br></pre></td></tr></table></figure>

<p>第一部分完成整体运行App如下图</p>
<p><img src="https://gitee.com/zhu565615430/images/raw/master/imas/May-13-2021%2015-05-20.gif" alt="May-13-2021 15-05-20"></p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  


  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/page/2/"><i class="fa fa-angle-left" aria-label="上一页"></i></a><a class="page-number" href="/">1</a><a class="page-number" href="/page/2/">2</a><span class="page-number current">3</span>
  </nav>



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="zhuguanliang"
      src="/images/avatar.png">
  <p class="site-author-name" itemprop="name">zhuguanliang</p>
  <div class="site-description" itemprop="description"> iOS developer</div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">26</span>
          <span class="site-state-item-name">文章</span>
        </a>
      </div>
  </nav>
</div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 2018 – 
  <span itemprop="copyrightYear">2021</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">zhuguanliang</span>
</div>

        








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/pisces.js"></script>


<script src="/js/next-boot.js"></script>




  




  
<script src="/js/local-search.js"></script>













  

  


</body>
</html>
